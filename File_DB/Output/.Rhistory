install.packages("tidyverse")
install.packages("readxl")
install.packages("visNetwork")
install.packages(c("writexl", "igraph"))
install.packages("readr")
library("stringr")
vignette("tibble")
library(tidyverse)
as.tibble(iris)
as_tibble(iris)
tibble(
x = 1:10,
y = x * 2,
z = sqrt(y)
)
tb <- tibble(
x = 1:10,
y = x * 2,
z = sqrt(y),
x = sample(letters, 1e3, replace = T)
)
tb <- tibble(
x = 1:10,
y = x * 2,
z = sqrt(y),
x = sample(letters, 1e3, replace = F)
)
tb <- tibble(
x = 1:30,
y = x * 2,
z = sqrt(y),
x = sample(letters, 1e3, replace = T)
)
tb <- tibble(
x = 1:30,
y = x * 2,
z = sqrt(y),
S = sample(letters, 1e3, replace = T)
)
tb <- tibble(
x = 1:30,
y = x * 2,
z = sqrt(y),
S = sample(letters, 30, replace = T)
)
View(tb)
tb <- tibble(
x = 1:30,
y = x * 2,
z = sqrt(y),
S = sample(letters, length(x), replace = T)
)
View(tb)
runif
runif(5)
DataLubri <- lubridate::now()
DataLubri <- DataLubri + runif(10)
DataLubri
DataLubri <- DataLubri + runif(10)*100000
nycflights13::flights %>%
print(n = 10, width = Inf)
tb %>% print(n = 9, width = Inf)
tb %>% print(n = 5, width = Inf)
tb %>% print(n = 5, width = 1)
tb %>% print(n = 5, width = 2)
df <- tibble(
x = runif(5),
y = rnorm(5)
)
tb %>% print(n = 5, width = Inf)
df$x
df %>% .x
df %>% .$x
mtcars
as_tibble(mtcars)
class(as_tibble(mtcars))
as_tibble(mtcars)
class(mtcars)
data_frame(abc = 1, xyz = "a")
data.frame(abc = 1, xyz = "a")
df <- data.frame(abc = 1, xyz = "a")
df$x
df[,"xyz"]
df[, c("abc", "xyz")]
var <- "mpg"
df$var
tibble(mtcars)
var <- "mpg"
df <- tibble(mtcars)
var <- "mpg"
df$var
df$mpg
df %>% var
df::var
var <- df$mpg
var
read_csv(mtcars)
read_csv()
read_csv("nome,cognome,età
Stefano, pagano, 30
Sara, Lia, 27")"
)
""
read_csv("nome,cognome,età
Stefano, pagano, 30
Sara, Lia, 27")
read_csv("1,2,3\n4,5,6", col_names = c("x", "y", "z"))
read_csv("1,2,3\n4,5,6", col_names = c("A", "B", "C"))
fruit <- c("apple","banana","nut")
parse_factor(c("apple","banana","nut","pippo"), levels = fruit)
table1
table1 %>% mutate(rate = cases / population * 10000)
table1 %>% count(year, wt = cases)
library(ggplot2)
ggplot(table1, aes(year, cases)) +
geom_line(aes(groub = country), colour = "grey50") +
geom_point(aes(colour = country))
ggplot(table1, aes(year, cases)) +
geom_line(aes(group = country), colour = "grey50") +
geom_point(aes(colour = country))
?save
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mclogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>% mutate(Delta_Avg = Avg_NE - Avg_coop,
Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type)) %>% subset.data.frame(subset = PaperID !="2017Del037")
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
Bas115 = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115") %>% mutate(payoff=endowment-scenarios)
clogit.bas <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115)
summary(clogit.bas)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
Bas115 = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115") %>% mutate(payoff=endowment-scenarios)
clogit.bas <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115)
summary(clogit.bas)
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
between <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = individual_db_b)
betas=between$coefficients
sigma=sqrt(between$var) # diagonal is variance; others are covariance
plot_model(model = between )
between <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = individual_db_b)
betas=between$coefficients
summary(between)
sigma=sqrt(between$var) # diagonal is variance; others are covariance
plot_model(model = between )
Kim003 = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003") %>% mutate(payoff=endowment-scenarios)
clogit.kim <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Kim003)
summary(clogit.kim)
betas=clogit.kim$coefficients
sigma=sqrt(clogit.kim$var) # diagonal is variance; others are covariance
plot_model(model = clogit.kim, title = "2016Kim003: Conditional Logit Model")
Her061 = individual_db_b %>% subset.data.frame(paper_id=="2018Her061") %>% mutate(payoff=endowment-scenarios)
clogit.her <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Her061)
summary(clogit.her)
betas=clogit.her$coefficients
sigma=sqrt(clogit.her$var) # diagonal is variance; others are covariance
plot_model(model = clogit.her, title = "2018Her061: Conditional Logit Model")
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
clogit.cha <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Cha026)
summary(clogit.cha)
betas=clogit.cha$coefficients
sigma=sqrt(clogit.cha$var) # diagonal is variance; others are covariance
plot_model(model = clogit.cha, title = "2019Cha026: Conditional Logit Model")
plot_models(between, Bas115)
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
clogit.cha <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Cha026)
summary(clogit.cha)
betas=clogit.cha$coefficients
sigma=sqrt(clogit.cha$var) # diagonal is variance; others are covariance
plot_model(model = clogit.cha, title = "2019Cha026: Conditional Logit Model")
plot_models(c(between, Bas115)
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
clogit.cha <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Cha026)
summary(clogit.cha)
betas=clogit.cha$coefficients
sigma=sqrt(clogit.cha$var) # diagonal is variance; others are covariance
plot_model(model = clogit.cha, title = "2019Cha026: Conditional Logit Model")
plot_models(c(between, Bas115))
plot_models(Kim003, Cha026)
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
clogit.cha <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Cha026)
summary(clogit.cha)
betas=clogit.cha$coefficients
sigma=sqrt(clogit.cha$var) # diagonal is variance; others are covariance
plot_model(model = clogit.cha, title = "2019Cha026: Conditional Logit Model")
plot_models(Kim003, Cha026)
library(tidyverse)
library(readxl)
rm(list = ls())
# Run paper script
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2016Kim003.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2019Cha026.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2017Tho028.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2015Ves034.R")
#problema paper... forse la task iniziale influenza molto la norma... non è 50% ma 83%
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2017Del037.R")
# i trattamenti sono diversi in base alla nazione... mancano i dati sulle norme
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2018Kim038.R")
# media norma 100%
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2017Ves049.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2019Tjo060.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2018Her061.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2019Dro082.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2020And089.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2020Bas115.R")
# mancano i dati di kw, da richiedere
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2017Sen116.R")
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_script/")
source("2021Kon127.R")
rm(list = ls())
# Create the master file -> merge all csv file
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/Paper_csv/")
Paper_003=read.csv("2016Kim003_finaldf.csv", sep=",")
master <- Paper_003
Paper_026=read.csv("2019Cha026_finaldf.csv", sep=",")
master <- Paper_026 %>%
rbind.data.frame(master)
Paper_028=read.csv("2017Tho028_finaldf.csv", sep=",")
master <- Paper_028 %>%
rbind.data.frame(master)
Paper_034=read.csv("2015Ves034_finaldf.csv", sep=",")
master <- Paper_034 %>%
rbind.data.frame(master)
Paper_037=read.csv("2017Del037_finaldf.csv", sep=",")
master <- Paper_037 %>%
rbind.data.frame(master)
Paper_038=read.csv("2018Kim038_finaldf.csv", sep=",")
master <- Paper_038 %>%
rbind.data.frame(master)
Paper_049=read.csv("2017Ves049_finaldf.csv", sep=",")
master <- Paper_049 %>%
rbind.data.frame(master)
Paper_060=read.csv("2019Tjo060_finaldf.csv", sep=",")
master <- Paper_060 %>%
rbind.data.frame(master)
Paper_061=read.csv("2018Her061_finaldf.csv", sep=",")
master <- Paper_061 %>%
rbind.data.frame(master)
Paper_082=read.csv("2019Dro082_finaldf.csv", sep=",")
master <- Paper_082 %>%
rbind.data.frame(master)
Paper_089=read.csv("2020And089_finaldf.csv", sep=",")
master <- Paper_089 %>%
rbind.data.frame(master)
Paper_115=read.csv("2020Bas115_finaldf.csv", sep=",")
master <- Paper_115 %>%
rbind.data.frame(master)
Paper_116=read.csv("2017Sen116_finaldf.csv", sep=",")
master <- Paper_116 %>%
rbind.data.frame(master)
Paper_127=read.csv("2021Kon127_finaldf.csv", sep=",")
master <- Paper_127 %>%
rbind.data.frame(master)
# save master file as csv
setwd("C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/File_DB/Output/")
write.csv(master, file = "Treatment.csv", row.names = F)
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mclogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = Sd_Avg_NE
# consistency = sqrt(Var_NE)
master = master %>% mutate(Norm_Strength = 1/sqrt(Var_NE) + 1/Sd_Avg_NE,
Delta = (Avg_NE-Avg_coop))
summary(master$Norm_Strength)
ggplot(data=master, aes(x=Norm_Strength)) +
geom_histogram() + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Macro_game_type)
cor.test(master$Norm_Strength, master$Delta, method= "spearman", exact = F)
ggplot(data=master, aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman")
ggplot(data=master, aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG")
hp4_mean <- master %>%
subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
group_by(Macro_game_type) %>%
summarise(Coop = mean(Avg_coop, na.rm = T),
Avg_Norm = mean(Avg_NE, na.rm = T),
Delta = mean(Delta, na.rm = T),
Strength = mean(Norm_Strength, na.rm = T),
n = n()) %>%
arrange(Macro_game_type)
master_test <- master %>% subset.data.frame(select = c(Game_type, Avg_coop, Avg_NE, Delta, Norm_Strength, Macro_game_type, Sd_Avg_NE, Var_NE), subset = Game_type %in% c("DG", "UG"))
wilc_delta = wilcox.test(Delta ~ Macro_game_type, data=master_test)
wilc_strength = wilcox.test(Norm_Strength ~ Macro_game_type, data = master_test)
wilc_coop = wilcox.test(Avg_coop ~ Macro_game_type, data = master_test)
wilc_norm = wilcox.test(Avg_NE ~ Macro_game_type, data = master_test)
hp4plus_mean <- hp4_mean %>% add_row(Macro_game_type = "Difference (Wilcoxon p-value)", Coop = wilc_coop$p.value, Avg_Norm = wilc_norm$p.value, Delta = wilc_delta$p.value, Strength = wilc_strength$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_mean, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Average and Mann-Whitney-Wilcoxon Test") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
# hp4_sd <- master %>%
#   subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
#   group_by(Macro_game_type) %>%
#   summarise(Coop = sd(Avg_coop, na.rm = T),
#             Avg_Norm = sd(Avg_NE, na.rm = T),
#             Delta = sd(Delta, na.rm = T),
#             Strength = sd(Norm_Strength, na.rm = T),
#             n = n()) %>%
#   arrange(Macro_game_type)
#
# opts <- options(knitr.kable.NA = "")
# kbl(hp4_sd, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Standard Deviation") %>%
#   kable_styling(position = "left", full_width = F) %>%
#   column_spec(1, bold = T)
hp4_SP_CS <- master %>%
subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
group_by(Macro_game_type) %>%
summarise(Specificity = mean(1/(Sd_Avg_NE), na.rm = T),
Consistency = mean(1/(sqrt(Var_NE)), na.rm = T)) %>%
arrange(Macro_game_type)
F_test_spec <- leveneTest(1/(master_test$Sd_Avg_NE) ~ master_test$Macro_game_type)
F_test_cons <- leveneTest(1/(sqrt(master_test$Var_NE)) ~ master_test$Macro_game_type)
View(F_test_spec)
View(F_test_spec)
View(F_test_spec)
F_test_spec
F_test_cons
ggplot(master_test) + geom_histogram(1/(Sd_Avg_NE))
master_test
ggplot(master_test) + geom_histogram(1/(Sd_Avg_NE))
ggplot(master_test) + geom_histogram(1/(master_test$Sd_Avg_NE))
ggplot(master_test) + geom_histogram(Sd_Avg_NE)
ggplot(master_test) + geom_histogram(aes(x=1/Sd_Avg_NE))
ggplot(master_test) + geom_histogram(aes(x=1/Sd_Avg_NE), xlab="Specificity")
ggplot(master_test) + geom_histogram(aes(x=1/Sd_Avg_NE)) + xlab("Specificity")
ggplot(master_test) + geom_boxplot(aes(x=1/Sd_Avg_NE)) + xlab("Specificity")
ggplot(master_test) + geom_boxplot(aes(x = Macro_game_type, y=1/Sd_Avg_NE)) + xlab("Specificity")
ggplot(master_test) + geom_boxplot(aes(x = Macro_game_type, y=1/Sd_Avg_NE)) + ylab("Specificity")
ggplot(master_test) + geom_boxplot(aes(x = Macro_game_type, y=1/sqrt(Var_NE))) + ylab("Specificity")
ggplot(master_test) + geom_boxplot(aes(x = Macro_game_type, y=1/sqrt(Var_NE))) + ylab("Consistency")
F_test_spec <- leveneTest((master_test$Sd_Avg_NE) ~ master_test$Macro_game_type)
F_test_spec
F_test_cons <- leveneTest((sqrt(master_test$Var_NE)) ~ master_test$Macro_game_type)
F_test_cons
F_test_spec <- leveneTest((master_test$Sd_Avg_NE^2) ~ master_test$Macro_game_type)
F_test_spec
F_test_cons <- leveneTest((master_test$Var_NE) ~ master_test$Macro_game_type)
F_test_cons
F_test_spec <- wilcox.test(1/(master_test$Sd_Avg_NE) ~ master_test$Macro_game_type)
F_test_spec
F_test_cons <- wilcox.test(1/(sqrt(master_test$Var_NE)) ~ master_test$Macro_game_type)
F_test_cons
ggplot(master_test) + geom_boxplot(aes(x = Macro_game_type, y=1/Sd_Avg_NE)) + ylab("Specificity")
ggplot(master_test) + geom_boxplot(aes(x = Macro_game_type, y=1/sqrt(Var_NE))) + ylab("Consistency")
ggplot(master_test) + geom_density(aes(x = Macro_game_type, y=1/Sd_Avg_NE)) + ylab("Specificity")
ggplot(master_test) + geom_densitty(aes(x = Macro_game_type, y=1/sqrt(Var_NE))) + ylab("Consistency")
ggplot(master_test) + geom_density(aes(x = Macro_game_type, y=1/sqrt(Var_NE))) + ylab("Consistency")
ggplot(master_test) + geom_density(aes(color = Macro_game_type, y=1/sqrt(Var_NE))) + ylab("Consistency")
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=1/sqrt(Var_NE))) + ylab("Consistency")
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=1/Sd_Avg_NE)) + ylab("Specificity")
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=1/Sd_Avg_NE)) + xlab("Specificity")
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=1/sqrt(Var_NE))) + xlab("Consistency"))
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=1/Sd_Avg_NE)) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=1/sqrt(Var_NE))) + xlab("Consistency"))
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=1/Sd_Avg_NE)) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=1/sqrt(Var_NE))) + xlab("Consistency"), common.legend = T)
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/Sd_Avg_NE)) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T)
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/Sd_Avg_NE)) + xlab("Specificity"),
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/Sd_Avg_NE)) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T))
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/Sd_Avg_NE))) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T)
