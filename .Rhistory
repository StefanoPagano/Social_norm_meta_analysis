colnames(Cha026_sub_1) <- c("subject","elicit_norms","frame_tax","endowment", "keep", "gender", "age","choice", "cooperation", "subject_id", "treatment_id", "paper_id")
Cha026_sub_1 <- Cha026_sub_1 %>%
subset.data.frame(select = -c(subject, elicit_norms, frame_tax, keep)) %>%
relocate(subject_id, treatment_id, paper_id, choice, endowment, cooperation, gender, age)
Choice_Cha026_DB_1 <- Cha026_sub_1
Cha026_KW_score_1 <- Cha026_db_norms_1 %>%
group_by(action) %>%
summarise(KW_Normative = mean(norm))
colnames(Cha026_KW_score_1) <- c("scenarios", "KW_Normative")
Individual_Cha026_DB_1 <- data.frame(p = NA, subject_id = NA, treatment_id = NA, paper_id = NA, scenarios = NA, choice = NA, endowment = NA, A = NA, gender = NA, age = NA, Design = NA)
dbbase <- Choice_Cha026_DB_1 %>%
mutate(n = c(1:length(Choice_Cha026_DB_1$subject_id)))
j = 1
for (x in dbbase$n) {
ewt = dbbase$endowment[x]
for (i in 0:ewt) {
new_line_DB <- data.frame(p = j,
subject_id = dbbase$subject_id[x],
treatment_id = dbbase$treatment_id[x],
paper_id = dbbase$paper_id[x],
scenarios = i,
choice = dbbase$choice[x],
endowment = dbbase$endowment[x],
A = 0,
gender = dbbase$gender[x],
age = dbbase$age[x],
Design = "Between")
Individual_Cha026_DB_1 <- new_line_DB %>% rbind.data.frame(Individual_Cha026_DB_1) %>% arrange(p)
j = j+1
}
}
Individual_Cha026_DB_1 <- Individual_Cha026_DB_1 %>%
subset.data.frame(subset = endowment > 0)
for (y in Individual_Cha026_DB_1$p) {
if (Individual_Cha026_DB_1$choice[y] == Individual_Cha026_DB_1$scenarios[y]) {Individual_Cha026_DB_1$A[y] = 1}
else {Individual_Cha026_DB_1$A[y] = 0}
}
Cha026_output_1 <- Individual_Cha026_DB_1 %>% merge.data.frame(Cha026_KW_score_1, by = c("scenarios")) %>%
arrange(subject_id, scenarios) %>%
relocate(p, subject_id, treatment_id, paper_id, scenarios, choice, A, endowment, gender, age, Design, KW_Normative) %>%
subset.data.frame(select = -c(p)) %>%
mutate(KW_Personal = NA,
Bicchieri_Empirical = NA,
Bicchieri_Normative = NA,
Bicchieri_Personal = NA)
# treatment frame tax
# n_progr_1 <- c(1:400)
Cha026_sub_2 <- Cha026 %>%
subset.data.frame(select = coldg, subset = frame_tax == 1) %>%
subset.data.frame(subset = elicit_norms == 0) %>%
subset.data.frame(subset = endowment == 10) %>%
mutate(sent = endowment - keep) %>%
mutate(coop = sent/endowment) %>%
mutate(subject_id = paste("2019Cha026", "2", subject, sep = "_")) %>%
mutate(treatment_id = paste("2019Cha026", "2", sep = "_"), paper_id = "2019Cha026")
colnames(Cha026_sub_2) <- c("subject","elicit_norms","frame_tax","endowment", "keep", "gender", "age","choice", "cooperation", "subject_id", "treatment_id", "paper_id")
Cha026_sub_2 <- Cha026_sub_2 %>%
subset.data.frame(select = -c(subject, elicit_norms, frame_tax, keep)) %>%
relocate(subject_id, treatment_id, paper_id, choice, endowment, cooperation, gender, age)
Choice_Cha026_DB_2 <- Cha026_sub_2
Cha026_KW_score_2 <- Cha026_db_norms_2 %>%
group_by(action) %>%
summarise(KW_Normative = mean(norm))
colnames(Cha026_KW_score_2) <- c("scenarios", "KW_Normative")
Individual_Cha026_DB_2 <- data.frame(p = NA, subject_id = NA, treatment_id = NA, paper_id = NA, scenarios = NA, choice = NA, endowment = NA, A = NA, gender = NA, age = NA, Design = NA)
dbbase <- Choice_Cha026_DB_2 %>%
mutate(n = c(1:length(Choice_Cha026_DB_2$subject_id)))
j = 1
for (x in dbbase$n) {
ewt = dbbase$endowment[x]
for (i in 0:ewt) {
new_line_DB <- data.frame(p = j,
subject_id = dbbase$subject_id[x],
treatment_id = dbbase$treatment_id[x],
paper_id = dbbase$paper_id[x],
scenarios = i,
choice = dbbase$choice[x],
endowment = dbbase$endowment[x],
A = 0,
gender = dbbase$gender[x],
age = dbbase$age[x],
Design = "Between")
Individual_Cha026_DB_2 <- new_line_DB %>% rbind.data.frame(Individual_Cha026_DB_2) %>% arrange(p)
j = j+1
}
}
Individual_Cha026_DB_2 <- Individual_Cha026_DB_2 %>%
subset.data.frame(subset = endowment > 0)
for (y in Individual_Cha026_DB_2$p) {
if (Individual_Cha026_DB_2$choice[y] == Individual_Cha026_DB_2$scenarios[y]) {Individual_Cha026_DB_2$A[y] = 1}
else {Individual_Cha026_DB_2$A[y] = 0}
}
Cha026_output_2 <- Individual_Cha026_DB_2 %>% merge.data.frame(Cha026_KW_score_1, by = c("scenarios")) %>%
arrange(subject_id, scenarios) %>%
relocate(p, subject_id, treatment_id, paper_id, scenarios, choice, A, endowment, gender, age, Design, KW_Normative) %>%
subset.data.frame(select = -c(p)) %>%
mutate(KW_Personal = NA,
Bicchieri_Empirical = NA,
Bicchieri_Normative = NA,
Bicchieri_Personal = NA)
#### Paper: 2016Kim003 ----
# set wd
setwd("G:/.shortcut-targets-by-id/1IoJDOQWCFiL1qTzSja6byrAlCelNSTsT/Meta-analysis beliefs/Dati paper/2016Kim003")
# choice file
Kim003=read.csv("DG_Data.csv", sep="\t")
# norms file
Kim003_db_norms=read.csv("Norm_Elicitation_Data.csv", sep = ",")
Kim003_db_norms <- Kim003_db_norms %>%
mutate(ANSW01 = recode(answers.1., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW02 = recode(answers.2., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW03 = recode(answers.3., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW04 = recode(answers.4., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW05 = recode(answers.5., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW06 = recode(answers.6., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW07 = recode(answers.7., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW08 = recode(answers.8., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW09 = recode(answers.9., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW12 = recode(answers.12., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW13 = recode(answers.13., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW14 = recode(answers.14., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW15 = recode(answers.15., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW16 = recode(answers.16., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW17 = recode(answers.17., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW18 = recode(answers.18., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW19 = recode(answers.19., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW20 = recode(answers.20., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW21 = recode(answers.21., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW22 = recode(answers.22., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW23 = recode(answers.23., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW24 = recode(answers.24., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW25 = recode(answers.25., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW26 = recode(answers.26., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW27 = recode(answers.27., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW28 = recode(answers.28., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW29 = recode(answers.29., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW30 = recode(answers.30., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW31 = recode(answers.31., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW34 = recode(answers.34., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW35 = recode(answers.35., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW36 = recode(answers.36., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW37 = recode(answers.37., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW38 = recode(answers.38., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW39 = recode(answers.39., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW40 = recode(answers.40., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW41 = recode(answers.41., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1),
ANSW42 = recode(answers.42., `0` = 0,`1` = -1, `2` = -1/3, `3` = 1/3, `4` = 1)) %>%
subset.data.frame(select = dg_columns <- c(1, 3, 4, 135:143))
# Subject ID (treatment neutrally 106, tax 266, tot 372)
coldg = c("subj_id", "role", "sent", "gender", "age")
# treatment neutrally
# n_progr_1 <- c(1:227)
Kim003_sub_1 <- Kim003 %>%
subset.data.frame(select = coldg, subset = role == 1) %>%
mutate(endowment = 16) %>%
mutate(coop = sent/endowment) %>%
mutate(agex= 2016-age) %>%
mutate(subject_id = paste("2016Kim003", "7", subj_id, sep = "_")) %>%
mutate(treatment_id = paste("2016Kim003", "7", sep = "_"), paper_id = "2016Kim003")
colnames(Kim003_sub_1) <- c("subj_id", "role", "choice", "gender", "year_sub", "endowment", "cooperation", "age", "subject_id", "treatment_id", "paper_id")
Kim003_sub_1 <- Kim003_sub_1 %>%
subset.data.frame(select = -c(subj_id, role, year_sub)) %>%
relocate(subject_id, treatment_id, paper_id, choice, endowment, cooperation, gender, age)
Choice_Kim003_DB <- Kim003_sub_1
Kim003_KW_score <- Kim003_db_norms %>%
pivot_longer(!c(X140626_1150, session, Subject), names_to = "scenarios", values_to = "KW_score") %>%
mutate(scenarios = as.numeric(recode(scenarios, `ANSW01` = 0, `ANSW02` = 2, `ANSW03` = 4, `ANSW04` = 6, `ANSW05` = 8, `ANSW06` = 10, `ANSW07` = 12, `ANSW08` = 14, `ANSW09` = 16))) %>%
subset.data.frame(select = -c(X140626_1150, session, Subject)) %>%
group_by(scenarios) %>%
summarise(KW_Normative = mean(KW_score))
Kim003_KW_score_add <- data.frame(scenarios = seq(1,15,2), KW_Normative = NA)
Kim003_KW_score_add$KW_Normative[1] = mean(c(Kim003_KW_score$KW_Normative[1],Kim003_KW_score$KW_Normative[2]))
Kim003_KW_score_add$KW_Normative[2] = mean(c(Kim003_KW_score$KW_Normative[2],Kim003_KW_score$KW_Normative[3]))
Kim003_KW_score_add$KW_Normative[3] = mean(c(Kim003_KW_score$KW_Normative[3],Kim003_KW_score$KW_Normative[4]))
Kim003_KW_score_add$KW_Normative[4] = mean(c(Kim003_KW_score$KW_Normative[4],Kim003_KW_score$KW_Normative[5]))
Kim003_KW_score_add$KW_Normative[5] = mean(c(Kim003_KW_score$KW_Normative[5],Kim003_KW_score$KW_Normative[6]))
Kim003_KW_score_add$KW_Normative[6] = mean(c(Kim003_KW_score$KW_Normative[6],Kim003_KW_score$KW_Normative[7]))
Kim003_KW_score_add$KW_Normative[7] = mean(c(Kim003_KW_score$KW_Normative[7],Kim003_KW_score$KW_Normative[8]))
Kim003_KW_score_add$KW_Normative[8] = mean(c(Kim003_KW_score$KW_Normative[8],Kim003_KW_score$KW_Normative[9]))
Kim003_KW_score <- Kim003_KW_score_add %>% rbind.data.frame(Kim003_KW_score) %>% arrange(scenarios)
Individual_Kim003_DB <- data.frame(p = NA, subject_id = NA, treatment_id = NA, paper_id = NA, scenarios = NA, choice = NA, endowment = NA, A = NA, gender = NA, age = NA, Design = NA)
dbbase <- Choice_Kim003_DB %>%
mutate(n = c(1:length(Choice_Kim003_DB$subject_id)))
j = 1
for (x in dbbase$n) {
ewt = dbbase$endowment[x]
for (i in 0:ewt) {
new_line_DB <- data.frame(p = j,
subject_id = dbbase$subject_id[x],
treatment_id = dbbase$treatment_id[x],
paper_id = dbbase$paper_id[x],
scenarios = i,
choice = dbbase$choice[x],
endowment = dbbase$endowment[x],
A = 0,
gender = NA,
age = NA,
Design = "Between")
Individual_Kim003_DB <- new_line_DB %>% rbind.data.frame(Individual_Kim003_DB) %>% arrange(p)
j = j+1
}
}
Individual_Kim003_DB <- Individual_Kim003_DB %>%
subset.data.frame(subset = endowment > 0)
for (y in Individual_Kim003_DB$p) {
if (Individual_Kim003_DB$choice[y] == Individual_Kim003_DB$scenarios[y]) {Individual_Kim003_DB$A[y] = 1}
else {Individual_Kim003_DB$A[y] = 0}
}
Kim003_output <- Individual_Kim003_DB %>% merge.data.frame(Kim003_KW_score, by = c("scenarios")) %>%
arrange(subject_id, scenarios) %>%
relocate(p, subject_id, treatment_id, paper_id, scenarios, choice, A, endowment, gender, age, Design, KW_Normative) %>%
subset.data.frame(select = -c(p)) %>%
mutate(KW_Personal = NA,
Bicchieri_Empirical = NA,
Bicchieri_Normative = NA,
Bicchieri_Personal = NA)
csv_path_output <- "C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/File_DB/"
#### CHOICES DB ----
# ONLY DG
#### Paper: 2020Bas115 ----
# set wd
setwd("G:/.shortcut-targets-by-id/1IoJDOQWCFiL1qTzSja6byrAlCelNSTsT/Meta-analysis beliefs/Dati paper/2020Bas115")
# choice file
Bas115=read.csv("Basic_Verrina_2021.csv", sep=",")
# norms file
ns_column = c(1,21:32)
Bas115_db_norms <- Bas115 %>% subset.data.frame(select = ns_column)
# recoding
Bas115_db_norms <- Bas115_db_norms %>%
mutate(DG_SN_1 = recode(dg_sn_1, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_2 = recode(dg_sn_2, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_3 = recode(dg_sn_3, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_4 = recode(dg_sn_4, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_5 = recode(dg_sn_5, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_6 = recode(dg_sn_6, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_7 = recode(dg_sn_7, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_8 = recode(dg_sn_8, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_9 = recode(dg_sn_9, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_10 = recode(dg_sn_10, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1),
DG_SN_11 = recode(dg_sn_11, `1` = -1, `2` = -0.6, `3` = -0.3, `4` = 0.3, `5` = 0.6, `6` = 1)) %>%
subset.data.frame(select = -c(dg_sn_1, dg_sn_2, dg_sn_3, dg_sn_4, dg_sn_5, dg_sn_6, dg_sn_7, dg_sn_8, dg_sn_9, dg_sn_10, dg_sn_11))
# Subject ID (treatment social 123, private 127 subjects, tot 250)
coldg = c("code","give","social","demo_gender","demo_age") #gender: 1-maschio, 0-femmina
# treatment social
# n_progr_1 <- c(1:123)
Bas115_sub_1a <- Bas115 %>%
subset.data.frame(select = coldg, subset = social == 1) %>%
mutate(endowment = 10) %>%
mutate(coop = give/endowment) %>%
mutate(subject_id = paste("2020Bas115", "1a", code, sep = "_")) %>%
mutate(treatment_id = paste("2020Bas115", "1a", sep = "_"), paper_id = "2020Bas115")
colnames(Bas115_sub_1a) <- c("code", "choice", "social", "gender", "age", "endowment", "cooperation", "subject_id", "treatment_id", "paper_id")
Bas115_sub_1a <- Bas115_sub_1a %>%
subset.data.frame(select = -c(code, social)) %>%
relocate(subject_id, treatment_id, paper_id, choice, endowment, cooperation, gender, age)
Choice_Within_DB <- Bas115_sub_1a
Bas115_norms_1a <- Bas115_db_norms %>%
subset.data.frame(subset = social == 1) %>%
mutate(subject_id = paste("2020Bas115", "1a", code, sep = "_")) %>%
mutate(treatment_id = paste("2020Bas115", "1a", sep = "_"), paper_id = "2020Bas115") %>%
relocate(paper_id) %>%
relocate(treatment_id) %>%
relocate(subject_id)
# treatment private
# n_progr_2 <- c(1:127)
Bas115_sub_2a <- Bas115 %>%
subset.data.frame(select = coldg, subset = social == 0) %>%
mutate(endowment = 10) %>%
mutate(coop = give/endowment) %>%
mutate(subject_id = paste("2020Bas115", "2a", code, sep = "_")) %>%
mutate(treatment_id = paste("2020Bas115", "2a", sep = "_"), paper_id = "2020Bas115")
colnames(Bas115_sub_2a) <- c("code", "choice", "social", "gender", "age", "endowment", "cooperation", "subject_id", "treatment_id", "paper_id")
Bas115_sub_2a <- Bas115_sub_2a %>%
subset.data.frame(select = -c(code, social)) %>%
relocate(subject_id, treatment_id, paper_id, choice, endowment, cooperation, gender, age)
Choice_Within_DB <- Bas115_sub_2a %>%
rbind.data.frame(Choice_Within_DB)
Bas115_norms_2a <- Bas115_db_norms %>%
subset.data.frame(subset = social == 0) %>%
mutate(subject_id = paste("2020Bas115", "2a", code, sep = "_")) %>%
mutate(treatment_id = paste("2020Bas115", "2a", sep = "_"), paper_id = "2020Bas115") %>%
relocate(paper_id) %>%
relocate(treatment_id) %>%
relocate(subject_id)
# PIVOT
Bas115_norms_all <- rbind.data.frame(Bas115_norms_1a, Bas115_norms_2a)
Bas115_norms_all <- Bas115_norms_all %>%
pivot_longer(!c(subject_id, treatment_id, paper_id, code, social), names_to = "scenarios", values_to = "KW_Normative") %>%
mutate(scenarios = as.numeric(recode(scenarios, `DG_SN_1` = 0, `DG_SN_2` = 1, `DG_SN_3` = 2, `DG_SN_4` = 3, `DG_SN_5` = 4, `DG_SN_6` = 5, `DG_SN_7` = 6, `DG_SN_8` = 7, `DG_SN_9` = 8, `DG_SN_10` = 9, `DG_SN_11` = 10))) %>%
subset.data.frame(select = -c(code, social))
#### Paper: 2017Del037 ----
# set wd
setwd("G:/.shortcut-targets-by-id/1IoJDOQWCFiL1qTzSja6byrAlCelNSTsT/Meta-analysis beliefs/Dati paper/2017Del037")
# choice file
Del037=read.csv("DATA_full.csv", sep=",") %>%
mutate(gender = recode(ANAGansw.1., `2` = 1, `4` = 0),
age = ANAGansw.2.)
Del037_db_norms <- Del037 %>%
subset.data.frame(select = c(ID, Treatment, Dictator,
KWansw.1.,
KWansw.2.,
KWansw.3.,
KWansw.4.,
KWansw.5.,
KWansw.6.,
KWansw.7.)) %>%
mutate(KW1 = recode(KWansw.1., `2` = -1, `4` = -1/3, `6` = 1/3, `8` = 1),
KW2 = recode(KWansw.2., `2` = -1, `4` = -1/3, `6` = 1/3, `8` = 1),
KW3 = recode(KWansw.3., `2` = -1, `4` = -1/3, `6` = 1/3, `8` = 1),
KW4 = recode(KWansw.4., `2` = -1, `4` = -1/3, `6` = 1/3, `8` = 1),
KW5 = recode(KWansw.5., `2` = -1, `4` = -1/3, `6` = 1/3, `8` = 1),
KW6 = recode(KWansw.6., `2` = -1, `4` = -1/3, `6` = 1/3, `8` = 1),
KW7 = recode(KWansw.7., `2` = -1, `4` = -1/3, `6` = 1/3, `8` = 1)) %>%
subset.data.frame(select = -c(KWansw.1., KWansw.2., KWansw.3., KWansw.4., KWansw.5., KWansw.6., KWansw.7.))
# Subject ID (treatment base 60, in 64, out 68 subjects, tot 192)
coldg = c("ID", "Treatment", "Dictator", "earn_TOT", "DICT_oth", "gender", "age")
# treatment base
# n_progr_1 <- c(1:60)
Del037_sub_1 <- Del037 %>%
subset.data.frame(select = coldg, subset = Treatment == "BASE") %>%
subset.data.frame(subset = Dictator == 1) %>%
mutate(endowment = earn_TOT) %>%
mutate(coop = DICT_oth/endowment) %>%
mutate(subject_id = paste("2017Del037", "1", ID, sep = "_")) %>%
mutate(treatment_id = paste("2017Del037", "1", sep = "_"), paper_id = "2017Del037")
colnames(Del037_sub_1) <- c("ID", "Treatment", "Dictator", "earn_TOT", "choice", "gender", "age", "endowment", "cooperation", "subject_id", "treatment_id", "paper_id")
Del037_sub_1 <- Del037_sub_1 %>%
subset.data.frame(select = -c(ID, Dictator, Treatment, earn_TOT)) %>%
relocate(subject_id, treatment_id, paper_id, choice, endowment, cooperation, gender, age)
Choice_Within_DB <- Del037_sub_1 %>%
rbind.data.frame(Choice_Within_DB)
Del037_norms_BASE <- Del037_db_norms %>%
subset.data.frame(subset = Treatment == "BASE") %>%
subset.data.frame(subset = Dictator == 1) %>%
mutate(subject_id = paste("2017Del037", "1", ID, sep = "_")) %>%
mutate(treatment_id = paste("2017Del037", "1", sep = "_"), paper_id = "2017Del037") %>%
relocate(paper_id) %>%
relocate(treatment_id) %>%
relocate(subject_id)
# treatment IN
# n_progr_1 <- c(1:64)
Del037_sub_2 <- Del037 %>%
subset.data.frame(select = coldg, subset = Treatment == "IN") %>%
subset.data.frame(subset = Dictator == 1) %>%
mutate(endowment = earn_TOT) %>%
mutate(coop = DICT_oth/endowment) %>%
mutate(subject_id = paste("2017Del037", "2", ID, sep = "_")) %>%
mutate(treatment_id = paste("2017Del037", "2", sep = "_"), paper_id = "2017Del037")
colnames(Del037_sub_2) <- c("ID", "Treatment", "Dictator", "earn_TOT", "choice", "gender", "age", "endowment", "cooperation", "subject_id", "treatment_id", "paper_id")
Del037_sub_2 <- Del037_sub_2 %>%
subset.data.frame(select = -c(ID, Dictator, Treatment, earn_TOT)) %>%
relocate(subject_id, treatment_id, paper_id, choice, endowment, cooperation, gender, age)
Choice_Within_DB <- Del037_sub_2 %>%
rbind.data.frame(Choice_Within_DB)
Del037_norms_IN <- Del037_db_norms %>%
subset.data.frame(subset = Treatment == "IN") %>%
subset.data.frame(subset = Dictator == 1) %>%
mutate(subject_id = paste("2017Del037", "2", ID, sep = "_")) %>%
mutate(treatment_id = paste("2017Del037", "2", sep = "_"), paper_id = "2017Del037") %>%
relocate(paper_id) %>%
relocate(treatment_id) %>%
relocate(subject_id)
# treatment OUT
# n_progr_1 <- c(1:68)
Del037_sub_3 <- Del037 %>%
subset.data.frame(select = coldg, subset = Treatment == "OUT") %>%
subset.data.frame(subset = Dictator == 1) %>%
mutate(endowment = earn_TOT) %>%
mutate(coop = DICT_oth/endowment) %>%
mutate(subject_id = paste("2017Del037", "3", ID, sep = "_")) %>%
mutate(treatment_id = paste("2017Del037", "3", sep = "_"), paper_id = "2017Del037")
colnames(Del037_sub_3) <- c("ID", "Treatment", "Dictator", "earn_TOT", "choice", "gender", "age", "endowment", "cooperation", "subject_id", "treatment_id", "paper_id")
Del037_sub_3 <- Del037_sub_3 %>%
subset.data.frame(select = -c(ID, Dictator, Treatment, earn_TOT)) %>%
relocate(subject_id, treatment_id, paper_id, choice, endowment, cooperation, gender, age)
Choice_Within_DB <- Del037_sub_3 %>%
rbind.data.frame(Choice_Within_DB)
Del037_norms_OUT <- Del037_db_norms %>%
subset.data.frame(subset = Treatment == "OUT") %>%
subset.data.frame(subset = Dictator == 1) %>%
mutate(subject_id = paste("2017Del037", "3", ID, sep = "_")) %>%
mutate(treatment_id = paste("2017Del037", "3", sep = "_"), paper_id = "2017Del037") %>%
relocate(paper_id) %>%
relocate(treatment_id) %>%
relocate(subject_id)
# PIVOT
Del037_norms_all <- rbind.data.frame(Del037_norms_BASE, Del037_norms_IN, Del037_norms_OUT)
#da confermare ordine score kw
Del037_norms_all <- Del037_norms_all %>%
pivot_longer(!c(subject_id, treatment_id, paper_id, ID, Treatment, Dictator), names_to = "scenarios", values_to = "KW_Normative") %>%
mutate(scenarios = as.numeric(recode(scenarios, `KW1` = 6, `KW2` = 5, `KW3` = 4, `KW4` = 3, `KW5` = 2, `KW6` = 1, `KW7` = 0))) %>%
subset.data.frame(select = -c(ID, Treatment, Dictator))
#### INDIVIDUAL DB (ONLY WITHIN DESIGN) ----
Individual_Within_DB <- data.frame(p = NA, subject_id = NA, treatment_id = NA, paper_id = NA, scenarios = NA, choice = NA, endowment = NA, A = NA, gender = NA, age = NA, Design = NA)
dbbase <- Choice_Within_DB %>%
subset.data.frame(subset = paper_id %in% c("2020Bas115", "2017Del037")) %>%
mutate(n = c(1:length(Choice_Within_DB$subject_id)))
j = 1
for (x in dbbase$n) {
ewt = dbbase$endowment[x]
for (i in 0:ewt) {
new_line_DB <- data.frame(p = j,
subject_id = dbbase$subject_id[x],
treatment_id = dbbase$treatment_id[x],
paper_id = dbbase$paper_id[x],
scenarios = i,
choice = dbbase$choice[x],
endowment = dbbase$endowment[x],
A = 0,
gender = dbbase$gender[x],
age = dbbase$age[x],
Design = "Within")
Individual_Within_DB <- new_line_DB %>% rbind.data.frame(Individual_Within_DB) %>% arrange(p)
j = j+1
}
}
Individual_Within_DB <- Individual_Within_DB %>%
subset.data.frame(subset = endowment > 0)
for (y in Individual_Within_DB$p) {
if (Individual_Within_DB$choice[y] == Individual_Within_DB$scenarios[y]) {Individual_Within_DB$A[y] = 1}
else {Individual_Within_DB$A[y] = 0}
}
Bas115_output <- Individual_Within_DB %>% merge.data.frame(Bas115_norms_all, by = c("subject_id", "scenarios", "treatment_id", "paper_id")) %>%
arrange(subject_id, scenarios) %>%
relocate(p, subject_id, treatment_id, paper_id, scenarios, choice, A, endowment, gender, age, Design, KW_Normative) %>%
subset.data.frame(select = -c(p)) %>%
mutate(KW_Personal = NA,
Bicchieri_Empirical = NA,
Bicchieri_Normative = NA,
Bicchieri_Personal = NA)
Del037_output <- Individual_Within_DB %>% merge.data.frame(Del037_norms_all, by = c("subject_id", "scenarios", "treatment_id", "paper_id")) %>%
arrange(subject_id, scenarios) %>%
relocate(p, subject_id, treatment_id, paper_id, scenarios, choice, A, endowment, gender, age, Design, KW_Normative) %>%
subset.data.frame(select = -c(p)) %>%
mutate(KW_Personal = NA,
Bicchieri_Empirical = NA,
Bicchieri_Normative = NA,
Bicchieri_Personal = NA)
csv_path_output <- "C:/Users/stefa/Documents/CNR/GitHub/Social_norm_meta_analysis/File_DB/Output/"
# Subjects choices file
Choice_DB <- rbind(Individual_Cha026_DB_1, Individual_Cha026_DB_2, Individual_Her061_DB, Individual_Kim003_DB, Individual_Within_DB) %>%
subset.data.frame(select = -c(p))
write.csv(Choice_DB, file = paste(csv_path_output, "Subjects_choices.csv", sep = ""), row.names = F)
# Subjects beliefs file
Belief_DB <- rbind(Bas115_output, Del037_output, Cha026_output_1, Cha026_output_2, Her061_output, Kim003_output) %>%
subset.data.frame(select = -c(choice, endowment, gender, age, A))
write.csv(Belief_DB, file = paste(csv_path_output, "Subjects_beliefs.csv", sep = ""), row.names = F)
View(Belief_DB)
library(ggplot2)
library(tidyverse)
library(mclogit)
library(sjmisc)
library(ggrepel)
library(sjPlot)
setwd("C:/Users/stefa/Documenti/GitHub/Social_norm_meta_analysis/")
setwd("C:/Users/stefa/Documents/GitHub/Social_norm_meta_analysis/")
setwd("C:/Users/stefa/Documenti/CNR/GitHub/Social_norm_meta_analysis/")
# read data
master <- read.csv("File_DB/Output/Treatment.csv")
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG")
# H1 : correlation between average cooperation and norm (NE)
cor.test(master$Avg_coop, master$Avg_NE, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID)) + ggtitle("H1 : correlation between average cooperation and norm (NE)")
View(master)
View(master)
# H2a : correlation between average cooperation and norm (NE)
cor.test(master$Avg_coop, master$Sd_Avg_NE, method= "spearman", exact = F)
ggplot(data=master, aes(x=Sd_Avg_NE, y=Avg_coop, color=Game_type)) + geom_point() + geom_smooth() + geom_text(aes(label=PaperID)) + ggtitle("H2a : correlation between average cooperation and norm (NE)")
# H2b : correlation between variance cooperation and norm (NE)
cor.test(master$Var_coop, master$Sd_Avg_NE, method= "spearman", exact = F)
ggplot(data=master, aes(x=Sd_Avg_NE, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + geom_text(aes(label=PaperID)) + ggtitle("H2b : correlation between variance cooperation and norm (NE)")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>% mutate(scarto = Avg_coop - Avg_NE)
View(master)
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>% mutate(scarto = Avg_NE - Avg_coop)
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>% mutate(scarto = Avg_NE - Avg_coop, Strength_N = scarto/Sd_Avg_NE)
# H1 : correlation between average cooperation and norm (NE)
cor.test(master$Avg_coop, master$Avg_NE, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID)) + ggtitle("H1 : correlation between average cooperation and norm (NE)")
# H2a : correlation between average cooperation and norm (NE)
cor.test(master$Avg_coop, master$Strength_N, method= "spearman", exact = F)
ggplot(data=master, aes(x=Strength_N, y=Avg_coop, color=Game_type)) + geom_point() + geom_smooth() + geom_text(aes(label=PaperID)) + ggtitle("H2a : correlation between average cooperation and norm (NE)")
# H2b : correlation between variance cooperation and norm (NE)
cor.test(master$Var_coop, master$Strength_N, method= "spearman", exact = F)
ggplot(data=master, aes(x=Strength_N, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + geom_text(aes(label=PaperID)) + ggtitle("H2b : correlation between variance cooperation and norm (NE)")
#H3
cor.test(master$Avg_coop, master$Strength_N, method= "spearman", exact = F)
ggplot(data=master, aes(x=Strength_N, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID)) + ggtitle("H3")
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG")
# H1
cor.test(DG$Avg_coop, DG$Avg_NE, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID)) + ggtitle("H1 : correlation between average cooperation and norm (NE) \n DG only")
# H2a : correlation between average cooperation and norm (NE)
cor.test(DG$Avg_coop, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_NE, y=Avg_coop)) + geom_point() + geom_smooth() + geom_text(aes(label=PaperID)) + ggtitle("H2a : correlation between average cooperation and norm (NE) \n DG only")
# H1
cor.test(DG$Avg_coop, DG$Avg_NE, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID)) + ggtitle("H1 : correlation between average cooperation and norm (NE) \n DG only")
# H2a : correlation between average cooperation and norm (NE)
cor.test(DG$Avg_coop, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Avg_coop)) + geom_point() + geom_smooth() + geom_text(aes(label=PaperID)) + ggtitle("H2a : correlation between average cooperation and norm (NE) \n DG only")
# H2b : correlation between variance cooperation and norm (NE)
cor.test(DG$Var_coop, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + geom_text(aes(label=PaperID)) + ggtitle("H2b : correlation between variance cooperation and norm (NE) \n DG only")
#H3
cor.test(DG$Avg_coop, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID)) + ggtitle("H3 \n DG only")
