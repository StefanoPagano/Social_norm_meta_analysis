install.packages("tidyverse")
install.packages("readxl")
install.packages("visNetwork")
install.packages(c("writexl", "igraph"))
install.packages("readr")
library("stringr")
vignette("tibble")
library(tidyverse)
as.tibble(iris)
as_tibble(iris)
tibble(
x = 1:10,
y = x * 2,
z = sqrt(y)
)
tb <- tibble(
x = 1:10,
y = x * 2,
z = sqrt(y),
x = sample(letters, 1e3, replace = T)
)
tb <- tibble(
x = 1:10,
y = x * 2,
z = sqrt(y),
x = sample(letters, 1e3, replace = F)
)
tb <- tibble(
x = 1:30,
y = x * 2,
z = sqrt(y),
x = sample(letters, 1e3, replace = T)
)
tb <- tibble(
x = 1:30,
y = x * 2,
z = sqrt(y),
S = sample(letters, 1e3, replace = T)
)
tb <- tibble(
x = 1:30,
y = x * 2,
z = sqrt(y),
S = sample(letters, 30, replace = T)
)
View(tb)
tb <- tibble(
x = 1:30,
y = x * 2,
z = sqrt(y),
S = sample(letters, length(x), replace = T)
)
View(tb)
runif
runif(5)
DataLubri <- lubridate::now()
DataLubri <- DataLubri + runif(10)
DataLubri
DataLubri <- DataLubri + runif(10)*100000
nycflights13::flights %>%
print(n = 10, width = Inf)
tb %>% print(n = 9, width = Inf)
tb %>% print(n = 5, width = Inf)
tb %>% print(n = 5, width = 1)
tb %>% print(n = 5, width = 2)
df <- tibble(
x = runif(5),
y = rnorm(5)
)
tb %>% print(n = 5, width = Inf)
df$x
df %>% .x
df %>% .$x
mtcars
as_tibble(mtcars)
class(as_tibble(mtcars))
as_tibble(mtcars)
class(mtcars)
data_frame(abc = 1, xyz = "a")
data.frame(abc = 1, xyz = "a")
df <- data.frame(abc = 1, xyz = "a")
df$x
df[,"xyz"]
df[, c("abc", "xyz")]
var <- "mpg"
df$var
tibble(mtcars)
var <- "mpg"
df <- tibble(mtcars)
var <- "mpg"
df$var
df$mpg
df %>% var
df::var
var <- df$mpg
var
read_csv(mtcars)
read_csv()
read_csv("nome,cognome,età
Stefano, pagano, 30
Sara, Lia, 27")"
)
""
read_csv("nome,cognome,età
Stefano, pagano, 30
Sara, Lia, 27")
read_csv("1,2,3\n4,5,6", col_names = c("x", "y", "z"))
read_csv("1,2,3\n4,5,6", col_names = c("A", "B", "C"))
fruit <- c("apple","banana","nut")
parse_factor(c("apple","banana","nut","pippo"), levels = fruit)
table1
table1 %>% mutate(rate = cases / population * 10000)
table1 %>% count(year, wt = cases)
library(ggplot2)
ggplot(table1, aes(year, cases)) +
geom_line(aes(groub = country), colour = "grey50") +
geom_point(aes(colour = country))
ggplot(table1, aes(year, cases)) +
geom_line(aes(group = country), colour = "grey50") +
geom_point(aes(colour = country))
?save
hist(master$Strength_N, breaks = 20, main = "Histogram of Strength Norm", xlab = "Strength Norm")
library(ggplot2)
library(tidyverse)
library(mclogit)
library(sjmisc)
library(ggrepel)
library(readxl)
setwd("C:/Users/stefa/Documenti/CNR/GitHub/Social_norm_meta_analysis/")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>% mutate(Delta_Avg = Avg_NE - Avg_coop, Strength_N = Delta_Avg/Sd_Avg_NE)
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG")
hist(master$Strength_N, breaks = 20, main = "Histogram of Strength Norm", xlab = "Strength Norm")
master %>% subset.data.frame(subset = Strength_N>5)
Strenght_stat_df <- master %>% subset.data.frame(subset = Strength_N>5)
summary(Strenght_stat_df$Strength_N)
hist(Strenght_stat_df$Strength_N, breaks = 20, main = "Histogram of Strength Norm", xlab = "Strength Norm")
Strenght_stat_df <- master %>% subset.data.frame(subset = Strength_N<5)
summary(Strenght_stat_df$Strength_N)
hist(Strenght_stat_df$Strength_N, breaks = 20, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 10, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 5, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 7, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 10, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 30, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 10, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "blue", col = "dark blue")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "dark blue", col = "blue")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "dark blue", col = "005f73")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "dark blue", col = "#005f73")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "#264653", col = "#005f73")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "#005f73", col = "#0a9396")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "#005f73", col = "#0a9396", bg = "black")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "#005f73", col = "#0a9396", col.bg = "blue")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "#005f73", col = "#0a9396", color.hist = "blue")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Strength Norm", xlab = "Strength Norm", border = "#edf6f9", col = "#001d3d")
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Does higher norm strength lead to higher norm compliance?")
hist(Strenght_stat_df$Strength_N, breaks = 6, main = "Histogram of Norm Strength", xlab = "Strength Norm", border = "#edf6f9", col = "#001d3d")
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Does higher norm strength lead to higher norm compliance?")
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm")
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm") + geom_label(Strenght_stat_df$PaperID)
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm") + geom_label(aes(Strenght_stat_df$PaperID))
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID))
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg, color=Game_type)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID))
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg, color=Game_type)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID))
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID))
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm")# + geom_text(aes(label=PaperID))
cor.test(DG$Avg_coop, DG$Avg_NE, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("H1 : correlation between average cooperation and norm (NE) \n DG only")
cor.test(DG$Avg_coop, DG$Avg_NE, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("H1 : correlation between average cooperation and norm (NE)\nDG only")
cor.test(DG$Avg_coop, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Avg_coop)) + geom_point() + geom_smooth() + ggtitle("H2a : correlation between average cooperation and norm (NE) \n DG only")
cor.test(DG$Avg_coop, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Avg_coop)) + geom_point() + geom_smooth() + ggtitle("H2a : correlation between average cooperation and norm (NE)\nDG only")
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct") %>% subset.data.frame(subset = Strength_N<5)
cor.test(DG$Avg_coop, DG$Avg_NE, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("H1 : correlation between average cooperation and norm (NE)\nDG only")
cor.test(DG$Avg_coop, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Avg_coop)) + geom_point() + geom_smooth() + ggtitle("H2a : correlation between average cooperation and norm (NE)\nDG only")
cor.test(DG$Var_coop, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2b : correlation between variance cooperation and norm (NE) \n DG only")
cor.test(DG$Var_coop, DG$Var_NE, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Var_NE, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2b : correlation between variance cooperation and norm (NE) \n DG only")
cor.test(DG$Avg_coop, DG$Var_NE, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Var_NE, y=Avg_coop)) + geom_point() + geom_smooth() + ggtitle("H2a : correlation between average cooperation and norm (NE)\nDG only")
cor.test(DG$Delta_Avg, DG$Strength_N, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm") + ggtitle("H3 \n DG only")
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2a : correlation between average cooperation and norm (NE)")
cor.test(master$Avg_NE, master$Avg_copp, method= "spearman", exact = F)
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("H1 : correlation between average cooperation and norm (NE)")
cor.test(master$Var_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Var_NE, y=Avg_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2a : correlation between average cooperation and norm (NE)")
cor.test(master$Var_coop, master$Strength_N, method= "spearman", exact = F)
ggplot(data=master, aes(x=Var_NE, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2b : correlation between variance cooperation and norm (NE)")
cor.test(master$Var_coop, master$Var_NE, method= "spearman", exact = F)
ggplot(data=master, aes(x=Var_NE, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2b : correlation between variance cooperation and norm (NE)")
cor.test(master$Var_NE, master$Var_Coop, method= "spearman", exact = F)
cor.test(master$Var_NE, master$Var_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Var_NE, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2b : correlation between variance cooperation and norm (NE)")
cor.test(Strenght_stat_df$Delta_Avg, Strenght_stat_df$Strength_N, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Delta_Avg, y=Strength_N)) + geom_point() + geom_smooth(method = "lm")# + geom_text(aes(label=PaperID))
cor.test(Strenght_stat_df$Strength_N, Strenght_stat_df$Delta_Avg, method= "spearman", exact = F)
ggplot(data=Strenght_stat_df, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm")# + geom_text(aes(label=PaperID))
cor.test(DG$Var_NE, DG$Var_coop, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Var_NE, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2b : correlation between variance cooperation and norm (NE)\nDG only")
cor.test(DG$Avg_NE, DG$Avg_coop, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("H1 : correlation between average cooperation and norm (NE)\nDG only")
cor.test(master$Var_NE, master$Var_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Var_NE, y=Var_coop, color=Game_type)) + geom_point() + geom_smooth() + ggtitle("H2b : Correlation Between Variance Cooperation and Norm (NE)")
cor.test(DG$Strength_N, DG$Delta_Avg, method= "spearman", exact = F)
ggplot(data=DG, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm")
DGG <- DG %>% subset.data.frame(subset = Strength_N<5)
cor.test(DGG$Strength_N, DGG$Delta_Avg, method= "spearman", exact = F)
ggplot(data=DGG, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm")
cor.test(DGG$Strength_N, DGG$Delta_Avg, method= "spearman", exact = F)
ggplot(data=DGG, aes(x=Strength_N, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID))
data(Car)
library(mlogit)
data(Car)
Car$choice <- substr(Car$choice, 7, 7)
View(Car)
mlogit.Car <- mlogit.data(Car,
choice = 'choice',
shape = 'wide',
varying = 5:70,
sep="")
View(mlogit.Car)
model <- mlogit(choice ~ type + fuel + price | college,
data = mlogit.Car)
summary(model)
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>% mutate(Delta_Avg = Avg_NE - Avg_coop, Strength_N = Delta_Avg/Sd_Avg_NE)
setwd("C:/Users/stefa/Documenti/CNR/GitHub/Social_norm_meta_analysis/")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>% mutate(Delta_Avg = Avg_NE - Avg_coop, Strength_N = Delta_Avg/Sd_Avg_NE)
model1 <- mlogit(A ~ KW_Normative, data = master))
model1 <- mlogit(A ~ KW_Normative, data = master)
View(master)
# between design -----
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
## INDIVIDUAL-LEVEL ANALYSIS
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",")
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
## INDIVIDUAL-LEVEL ANALYSIS
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("File_DB/Output/Subjects_choices.csv", sep = ",")
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
model1 <- mlogit(A ~ KW_Normative, data = individual_db_w)
View(Car)
model1 <- mlogit(A ~ scenarios + KW_Normative, data = individual_db_w)
library(ggplot2)
library(tidyverse)
library(mclogit)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(sjPlot)
library(readxl)
setwd("C:/Users/stefa/Documenti/CNR/GitHub/Social_norm_meta_analysis/")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>% mutate(Delta_Avg = Avg_NE - Avg_coop, Strength_N = Delta_Avg/Sd_Avg_NE)
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct") %>% subset.data.frame(subset = Strength_N<5)
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG")
# H1 : correlation between average cooperation and norm (NE)
cor.test(master$Avg_coop, master$Avg_NE, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_coop, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID)) + ggtitle("H1 : correlation between average cooperation and norm (NE)")
View(master)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + geom_text(aes(label=PaperID)) + ggtitle("H1 : correlation between average cooperation and norm (NE)")
sqrt(0.5)
new_master = master %>% mutate(new_strenght = Avg_NE/(sqrt(Var_NE)+Sd_Avg_NE))
cor.test(new_master$new_strenght, new_master$Delta_Avg, method= "spearman", exact = F)
ggplot(data=new_master, aes(x=new_strenght, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm")# + geom_text(aes(label=PaperID))
new_master = master %>% mutate(new_strenght = Avg_NE/(sqrt(Var_NE)+Sd_Avg_NE))
cor.test(new_master$new_strenght, new_master$Delta_Avg, method= "spearman", exact = F)
ggplot(data=new_master, aes(x=new_strenght, y=Delta_Avg)) + geom_point() + geom_smooth(method = "lm")# + geom_text(aes(label=PaperID))
new_master = master %>% mutate(new_strenght = Avg_NE/(sqrt(Var_NE)+Sd_Avg_NE)) %>% subset
cor.test(Strenght_stat_df$Strength_N, Strenght_stat_df$Delta_Avg, method= "spearman", exact = F)
new_master = master %>% mutate(new_strenght = 1/(sqrt(Var_NE)+Sd_Avg_NE))
cor.test(new_master$new_strenght, new_master$Delta_Avg, method= "spearman", exact = F)
ggplot(data=new_master, aes(x=new_strenght, y=Delta_Avg, color=Game_type)) + geom_point() + geom_smooth(method = "lm")# + geom_text(aes(label=PaperID))
new_master = master %>% mutate(new_strenght = 1/(sqrt(Var_NE)+Sd_Avg_NE))
cor.test(new_master$new_strenght, new_master$Delta_Avg, method= "spearman", exact = F)
ggplot(data=new_master, aes(x=new_strenght, y=Delta_Avg, color=Game_type)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3)# + geom_text(aes(label=PaperID))
master %>% group_by(Game_type) %>% summarise(coop=mean(Avg_coop, na.rm=T),
norm=mean(Avg_NE, na.rm=T),
scarto=norm-coop,
strength=mean(Strength_N, na.rm=T)
)
new_master = master %>% mutate(new_strenght = 1/(sqrt(Var_NE)+Sd_Avg_NE)) %>% mutate(Delta_new = (Avg_NE-Avg_coop)/Avg_NE)
new_master %>% group_by(Game_type) %>% summarise(coop=mean(Avg_coop, na.rm=T),
norm=mean(Avg_NE, na.rm=T),
Delta=mean(Delta_new, na.rm=T),
strength=mean(new_strenght, na.rm=T)
)
