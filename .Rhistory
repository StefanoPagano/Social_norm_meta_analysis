geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Game_type)
cor.test(master$Norm_Strength, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
cor.test(master$specificity_min, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_min, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_min, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
summary(master$specificity_plus)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_plus)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Specificity (positive values)") + xlab("Specificity") + facet_wrap(~Game_type)
cor.test(master$specificity_plus, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_plus, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_plus, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
summary(master$specificity_min)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_min)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Specificity (negative values)") + xlab("Specificity") + facet_wrap(~Game_type)
summary(master$consistency)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Consistency") + xlab("Consistency") + facet_wrap(~Game_type)
cor.test(master$consistency, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
master$consistency
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type), SD_NE=sqrt(Var_NE)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = mean of max deviation
# consistency = sqrt(Var_NE)
# master = master %>% mutate(consistency_old = 1/sqrt(Var_NE),
#                            Norm_Strength_old = consistency_old + Sd_Avg_NE,
#                            Delta = Avg_NE-Avg_coop)
master = master %>% mutate(consistency=1-sqrt(Var_NE)/max_sigma,
consistency_old = 1/sqrt(Var_NE),
specificity_old = 1/Sd_Avg_NE,
Norm_Strength = consistency + specificity_plus,
Norm_Strength_old = consistency_old + specificity_old,
Delta = (Avg_NE-Avg_coop)/Avg_NE)
summary(master$Delta)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Delta)) +
geom_histogram(bins = 9, col=I("black")) + ggtitle("Histogram of Compliance") + xlab("Compliance (Delta)") + facet_wrap(~Game_type)
summary(master$Delta)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Delta)) +
geom_histogram(bins = 10, col=I("black")) + ggtitle("Histogram of Compliance") + xlab("Compliance (Delta)") + facet_wrap(~Game_type)
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type), SD_NE=sqrt(Var_NE)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = mean of max deviation
# consistency = sqrt(Var_NE)
# master = master %>% mutate(consistency_old = 1/sqrt(Var_NE),
#                            Norm_Strength_old = consistency_old + Sd_Avg_NE,
#                            Delta = Avg_NE-Avg_coop)
master = master %>% mutate(consistency=1-sqrt(Var_NE)/max_sigma,
consistency_old = 1/sqrt(Var_NE),
specificity_old = 1/Sd_Avg_NE,
Norm_Strength = consistency + specificity_plus,
Norm_Strength_old = consistency_old + specificity_old,
Delta = (Avg_NE-Avg_coop)/Avg_NE)
summary(master$Delta)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Delta)) +
geom_histogram(bins = 10, col=I("black")) + ggtitle("Histogram of Compliance") + xlab("Compliance (Delta)") + facet_wrap(~Game_type)
summary(master$Norm_Strength_old)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength_old)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Game_type)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength_old, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength_old, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
summary(master$specifity_old)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_old)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Specificity_old") + xlab("Specificity") + facet_wrap(~Game_type)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_old, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Sd_Avg_NE, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
summary(master$consistency_old)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency_old)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Consistency") + xlab("Consistency") + facet_wrap(~Game_type)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency_old, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency_old, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
summary(master$Norm_Strength)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Game_type)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
summary(master$specificity_plus)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_plus)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Specificity (positive values)") + xlab("Specificity") + facet_wrap(~Game_type)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_plus, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_plus, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
summary(master$consistency)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Consistency") + xlab("Consistency") + facet_wrap(~Game_type)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
summary(master$Avg_KW_m)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Avg_KW_m)) +
geom_histogram(bins = 7, col=I("black")) + ggtitle("Histogram of Norm Content") + xlab("Norm Content") + facet_wrap(~Game_type)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Avg_KW_m, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Avg_KW_m, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Avg_KW_m, y=specificity_plus)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Avg_KW_m, y=specificity_plus)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Avg_KW_m, y=consistency)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Avg_KW_m, y=consistency)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_min, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity_min, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
---
title: "dg_analysis"
author: "Sp & AG"
date: "19/1/2022"
output: html_document
---
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment="", include=FALSE}
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
filter(Game_type == "DG") %>%
subset.data.frame(subset = !(Standard_game %in% c("N")) & Choice_Method != "OnlyNorms" & StatusTreatment_Roma == "6-Complete" & Baseline %in% c(NA, 1))
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
choices <- read.csv("File_DB/Output/Subjects_choices.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
```
# Individual-level analyses
```{r}
# belief dataset aggregated to get appropriateness for each action
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between"&Game_type=="DG") %>% group_by(paper_id, treatment_id,scenarios) %>% summarise(KW_Normative = mean(KW_Normative, rm.na=T))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003" & treatment_id == "2016Kim003_7") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", treatment_id="2016Kim003_7", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
mean_beliefs <- beliefs %>% merge.data.frame(Kim003_interpolation, all = T) %>% group_by(paper_id, treatment_id, scenarios) %>% summarise(mean_app=mean(KW_Normative))
individual_db <- choices %>% merge.data.frame(mean_beliefs)%>% mutate(payoff=endowment-scenarios)
master$treatment_id = paste(master$PaperID,"_",master$TreatmentCode, sep="")
# mlogit
for (i in levels(as.factor(individual_db$treatment_id))) {
model=mclogit::mclogit(cbind(A,choice)~ payoff + mean_app, data=individual_db%>% filter(treatment_id==i))
print(i)
print(summary(model))
}
#mdata=mlogit.data(individual_db, chid.var = "scenarios")
#mlogit()
```
setwd("~/CNR/GitHub/Social_norm_meta_analysis")
---
title: "dg_analysis"
author: "Sp & AG"
date: "19/1/2022"
output: html_document
---
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment="", include=FALSE}
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
filter(Game_type == "DG") %>%
subset.data.frame(subset = !(Standard_game %in% c("N")) & Choice_Method != "OnlyNorms" & StatusTreatment_Roma == "6-Complete" & Baseline %in% c(NA, 1))
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
choices <- read.csv("File_DB/Output/Subjects_choices.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
```
# Individual-level analyses
```{r}
# belief dataset aggregated to get appropriateness for each action
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between"&Game_type=="DG") %>% group_by(paper_id, treatment_id,scenarios) %>% summarise(KW_Normative = mean(KW_Normative, rm.na=T))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003" & treatment_id == "2016Kim003_7") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", treatment_id="2016Kim003_7", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
mean_beliefs <- beliefs %>% merge.data.frame(Kim003_interpolation, all = T) %>% group_by(paper_id, treatment_id, scenarios) %>% summarise(mean_app=mean(KW_Normative))
individual_db <- choices %>% merge.data.frame(mean_beliefs)%>% mutate(payoff=endowment-scenarios)
master$treatment_id = paste(master$PaperID,"_",master$TreatmentCode, sep="")
# mlogit
for (i in levels(as.factor(individual_db$treatment_id))) {
model=mclogit::mclogit(cbind(A,choice)~ payoff + mean_app, data=individual_db%>% filter(treatment_id==i))
print(i)
print(summary(model))
}
#mdata=mlogit.data(individual_db, chid.var = "scenarios")
#mlogit()
```
---
title: "dg_analysis"
author: "Sp & AG"
date: "19/1/2022"
output: html_document
---
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment="", include=FALSE}
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
filter(Game_type == "DG") %>%
subset.data.frame(subset = !(Standard_game %in% c("N")) & Choice_Method != "OnlyNorms" & StatusTreatment_Roma == "6-Complete" & Baseline %in% c(NA, 1))
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
choices <- read.csv("File_DB/Output/Subjects_choices.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
```
# Individual-level analyses
```{r}
# belief dataset aggregated to get appropriateness for each action
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between"&Game_type=="DG") %>% group_by(paper_id, treatment_id,scenarios) %>% summarise(KW_Normative = mean(KW_Normative, rm.na=T))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003" & treatment_id == "2016Kim003_7") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", treatment_id="2016Kim003_7", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
mean_beliefs <- beliefs %>% merge.data.frame(Kim003_interpolation, all = T) %>% group_by(paper_id, treatment_id, scenarios) %>% summarise(mean_app=mean(KW_Normative))
individual_db <- choices %>% merge.data.frame(mean_beliefs)%>% mutate(payoff=endowment-scenarios)
master$treatment_id = paste(master$PaperID,"_",master$TreatmentCode, sep="")
# mlogit
for (i in levels(as.factor(individual_db$treatment_id))) {
model=mclogit::mclogit(cbind(A,choice)~ payoff + mean_app, data=individual_db%>% filter(treatment_id==i))
print(i)
print(summary(model))
}
#mdata=mlogit.data(individual_db, chid.var = "scenarios")
#mlogit()
```
---
title: "dg_analysis"
author: "Sp & AG"
date: "19/1/2022"
output: html_document
---
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment="", include=FALSE}
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
#setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
filter(Game_type == "DG") %>%
subset.data.frame(subset = !(Standard_game %in% c("N")) & Choice_Method != "OnlyNorms" & StatusTreatment_Roma == "6-Complete" & Baseline %in% c(NA, 1))
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
choices <- read.csv("File_DB/Output/Subjects_choices.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
```
# Individual-level analyses
```{r}
# belief dataset aggregated to get appropriateness for each action
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between"&Game_type=="DG") %>% group_by(paper_id, treatment_id,scenarios) %>% summarise(KW_Normative = mean(KW_Normative, rm.na=T))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003" & treatment_id == "2016Kim003_7") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", treatment_id="2016Kim003_7", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
mean_beliefs <- beliefs %>% merge.data.frame(Kim003_interpolation, all = T) %>% group_by(paper_id, treatment_id, scenarios) %>% summarise(mean_app=mean(KW_Normative))
individual_db <- choices %>% merge.data.frame(mean_beliefs)%>% mutate(payoff=endowment-scenarios)
master$treatment_id = paste(master$PaperID,"_",master$TreatmentCode, sep="")
# mlogit
for (i in levels(as.factor(individual_db$treatment_id))) {
model=mclogit::mclogit(cbind(A,choice)~ payoff + mean_app, data=individual_db%>% filter(treatment_id==i))
print(i)
print(summary(model))
}
#mdata=mlogit.data(individual_db, chid.var = "scenarios")
#mlogit()
```
---
title: "dg_analysis"
author: "Sp & AG"
date: "19/1/2022"
output: html_document
---
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment="", include=FALSE}
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
filter(Game_type == "DG") %>%
subset.data.frame(subset = !(Standard_game %in% c("N")) & Choice_Method != "OnlyNorms" & StatusTreatment_Roma == "6-Complete" & Baseline %in% c(NA, 1))
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
choices <- read.csv("File_DB/Output/Subjects_choices.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
```
# Individual-level analyses
```{r}
# belief dataset aggregated to get appropriateness for each action
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between"&Game_type=="DG") %>% group_by(paper_id, treatment_id,scenarios) %>% summarise(KW_Normative = mean(KW_Normative, rm.na=T))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003" & treatment_id == "2016Kim003_7") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", treatment_id="2016Kim003_7", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
mean_beliefs <- beliefs %>% merge.data.frame(Kim003_interpolation, all = T) %>% group_by(paper_id, treatment_id, scenarios) %>% summarise(mean_app=mean(KW_Normative))
individual_db <- choices %>% merge.data.frame(mean_beliefs)%>% mutate(payoff=endowment-scenarios)
master$treatment_id = paste(master$PaperID,"_",master$TreatmentCode, sep="")
# mlogit
for (i in levels(as.factor(individual_db$treatment_id))) {
model=mclogit::mclogit(cbind(A,choice)~ payoff + mean_app, data=individual_db%>% filter(treatment_id==i))
print(i)
print(summary(model))
}
#mdata=mlogit.data(individual_db, chid.var = "scenarios")
#mlogit()
```
setwd("~/CNR/GitHub/Social_norm_meta_analysis")
setwd("~/CNR/GitHub/Social_norm_meta_analysis/Analysis")
---
title: "dg_analysis"
author: "Sp & AG"
date: "19/1/2022"
output: html_document
---
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment="", include=FALSE}
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
filter(Game_type == "DG") %>%
subset.data.frame(subset = !(Standard_game %in% c("N")) & Choice_Method != "OnlyNorms" & StatusTreatment_Roma == "6-Complete" & Baseline %in% c(NA, 1))
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
choices <- read.csv("File_DB/Output/Subjects_choices.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
```
# Individual-level analyses
```{r}
# belief dataset aggregated to get appropriateness for each action
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between"&Game_type=="DG") %>% group_by(paper_id, treatment_id,scenarios) %>% summarise(KW_Normative = mean(KW_Normative, rm.na=T))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003" & treatment_id == "2016Kim003_7") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", treatment_id="2016Kim003_7", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
mean_beliefs <- beliefs %>% merge.data.frame(Kim003_interpolation, all = T) %>% group_by(paper_id, treatment_id, scenarios) %>% summarise(mean_app=mean(KW_Normative))
individual_db <- choices %>% merge.data.frame(mean_beliefs)%>% mutate(payoff=endowment-scenarios)
master$treatment_id = paste(master$PaperID,"_",master$TreatmentCode, sep="")
# mlogit
for (i in levels(as.factor(individual_db$treatment_id))) {
model=mclogit::mclogit(cbind(A,choice)~ payoff + mean_app, data=individual_db%>% filter(treatment_id==i))
print(i)
print(summary(model))
}
#mdata=mlogit.data(individual_db, chid.var = "scenarios")
#mlogit()
```
setwd("~/CNR/GitHub/Social_norm_meta_analysis/Analysis")
---
title: "dg_analysis"
author: "Sp & AG"
date: "19/1/2022"
output: html_document
---
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment="", include=FALSE}
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
getwd()
master <- read.csv("File_DB/Output/Treatment.csv") %>%
filter(Game_type == "DG") %>%
subset.data.frame(subset = !(Standard_game %in% c("N")) & Choice_Method != "OnlyNorms" & StatusTreatment_Roma == "6-Complete" & Baseline %in% c(NA, 1))
beliefs <- read.csv("File_DB/Output/Subjects_beliefs.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
choices <- read.csv("File_DB/Output/Subjects_choices.csv", sep = ",") %>%
filter(treatment_id %in% levels(as.factor(paste(master$PaperID,"_",master$TreatmentCode, sep=""))))
```
# Individual-level analyses
```{r}
# belief dataset aggregated to get appropriateness for each action
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between"&Game_type=="DG") %>% group_by(paper_id, treatment_id,scenarios) %>% summarise(avg_kw = mean(KW_Normative, rm.na=T),
sd_kw = sd(KW_Normative, na.rm = T))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003" & treatment_id == "2016Kim003_7") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", treatment_id="2016Kim003_7", scenarios=seq(1,15,2), avg_kw=NA, sd_kw=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(avg_kw, maxgap = 1, rule = 1),
sd_KW = na.approx(sd_kw, maxgap = 1, rule = 1))
mean_beliefs <- beliefs %>% merge.data.frame(Kim003_interpolation, all = T) %>% group_by(paper_id, treatment_id, scenarios) %>% summarise(mean_app=mean(KW_Normative), sd_app=mean(sd_KW))
individual_db <- choices %>% merge.data.frame(mean_beliefs)%>% mutate(payoff=endowment-scenarios)
master$treatment_id = paste(master$PaperID,"_",master$TreatmentCode, sep="")
# mlogit
for (i in levels(as.factor(individual_db$treatment_id))) {
model=mclogit::mclogit(cbind(A,choice)~ payoff + mean_app + sd_app, data=individual_db%>% filter(treatment_id==i))
print(i)
print(summary(model))
}
#mdata=mlogit.data(individual_db, chid.var = "scenarios")
#mlogit()
```
View(individual_db)
