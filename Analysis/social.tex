\hypertarget{analysis-treatment-level-all-games}{%
\section{Analysis Treatment-level: All
Games}\label{analysis-treatment-level-all-games}}

```\{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE,
comment=``\,``, include=FALSE\} rm(list=ls()) library(ggplot2)
library(tidyverse) library(mlogit) library(sjmisc) library(ggrepel)
library(readxl) library(ggpubr) library(survival) library(sjPlot)
library(kableExtra) library(car) library(DT) library(zoo)

setwd(``../'') \# read data getwd() master \textless-
read.csv(``File\_DB/Output/Treatment.csv'') \%\textgreater\%
mutate(Macro\_game\_type = ifelse(Game\_type \%in\% c(``DG'',``Donation
Game''), ``DG and Donation Game'', Game\_type), SD\_NE=sqrt(Var\_NE))
\%\textgreater\% subset.data.frame(subset = !(Standard\_game \%in\%
c(``N'')))

\begin{verbatim}

## HP1: Relation between norms and actions

<br>

<h4><i>Are norms and cooperation behavior related?</i></h4>

The content of the norm and behavior correlate positively.

```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment=""}
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
\end{verbatim}

\hypertarget{results}{%
\subsubsection{Results}\label{results}}

\begin{itemize}
\tightlist
\item
  Evidence from testing H1 shows that there is a positive and
  significant correlation between social expectations and cooperative
  behavior (Fig. 1).
\item
  By splitting data by game type, there is evidence of positive and
  significant correlation in DG (and Donation game), while norms are not
  heterogeneous in other game types.
\item
  Hence, the analysis including all games possibly makes more sense
  here.
\end{itemize}

\hypertarget{hp2-is-compliance-related-to-norm-strength}{%
\subsection{HP2 : Is compliance related to norm
strength?}\label{hp2-is-compliance-related-to-norm-strength}}

\hypertarget{summary-of-computed-variables}{%
\subsection{Summary of computed
variables}\label{summary-of-computed-variables}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ \#\ specificity\ =\ mean\ of\ max\ deviation\ \#\ consistency\ =\ sqrt(Var\_NE)\ \#\ master\ =\ master\ \%\textgreater{}\%\ mutate(consistency\_old\ =\ 1/sqrt(Var\_NE),\ \#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Norm\_Strength\_old\ =\ consistency\_old\ +\ Sd\_Avg\_NE,\ \#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Delta\ =\ Avg\_NE-Avg\_coop)\ master\ =\ master\ \%\textgreater{}\%\ mutate(consistency=1-sqrt(Var\_NE)/max\_sigma,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ consistency\_old\ =\ 1/sqrt(Var\_NE),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ specificity\_old\ =\ 1/Sd\_Avg\_NE,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Norm\_Strength\ =\ consistency\ +\ specificity\_plus,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Norm\_Strength\_old\ =\ consistency\_old\ +\ specificity\_old,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Delta\ =\ (Avg\_NE-Avg\_coop)/Avg\_NE)}

\hypertarget{delta-analysis}{%
\subsubsection{DELTA ANALYSIS}\label{delta-analysis}}

We compute \textbf{Compliance} as

\begin{itemize}
\tightlist
\item
  \(Delta = \frac{NE_{avg}-Coop_{avg}}{NE_{avg}}\)
\end{itemize}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ summary(master\$Delta)\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Delta))\ +\ geom\_histogram(bins\ =\ 10,\ col=I("black"))\ +\ ggtitle("Histogram\ of\ Compliance")\ +\ xlab("Compliance\ (Delta)")\ +\ facet\_wrap(\textasciitilde{}Game\_type)}

\hypertarget{strength-old-analysis}{%
\subsubsection{STRENGTH OLD ANALYSIS}\label{strength-old-analysis}}

We compute norm strength as:

\[Strength = {NE_{Consistency}+NE_{Specificity}}\]

where:

\textbf{Specificity} indicates how appropriate is prevailing social norm
relative to other possible action

\begin{itemize}
\tightlist
\item
  \(NE_{Specificity} = \frac{1}{\sigma_j}\) \(\forall KW_j\) is the
  reciprocal of the standard deviation computed on Krupka-Weber average
  appropriateness scores across all actions j
\end{itemize}

\textbf{Consistency} indicates what it is the consensus around a
prevailing social norm

\begin{itemize}
\tightlist
\item
  \(NE_{Consistency} = {1 \over \sigma_{N}}\) is the reciprocal of the
  standard deviation computed on the most appropriate action N
\end{itemize}

\hypertarget{norm-strength}{%
\paragraph{Norm Strength}\label{norm-strength}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ summary(master\$Norm\_Strength\_old)\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Norm\_Strength\_old))\ +\ geom\_histogram(bins\ =\ 7,\ col=I("black"))\ +\ ggtitle("Histogram\ of\ Norm\ Strength")\ +\ xlab("Strength\ Norm")\ +\ facet\_wrap(\textasciitilde{}Game\_type)}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Norm\_Strength\_old,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Norm\_Strength\_old,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\hypertarget{specificity_old}{%
\paragraph{Specificity\_old}\label{specificity_old}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ summary(master\$specifity\_old)\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=specificity\_old))\ +\ geom\_histogram(bins\ =\ 7,\ col=I("black"))\ +\ ggtitle("Histogram\ of\ Specificity\_old")\ +\ xlab("Specificity")\ +\ facet\_wrap(\textasciitilde{}Game\_type)}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=specificity\_old,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Sd\_Avg\_NE,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\hypertarget{consistency_old}{%
\paragraph{consistency\_old}\label{consistency_old}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ summary(master\$consistency\_old)\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=consistency\_old))\ +\ geom\_histogram(bins\ =\ 7,\ col=I("black"))\ +\ ggtitle("Histogram\ of\ Consistency")\ +\ xlab("Consistency")\ +\ facet\_wrap(\textasciitilde{}Game\_type)}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=consistency\_old,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=consistency\_old,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\hypertarget{strength-new-analysis}{%
\subsubsection{STRENGTH NEW ANALYSIS}\label{strength-new-analysis}}

\textbf{Overview of the computed statistics}

\[Strength = {NE_{Consistency}+NE_{Specificity^+}}\]

\(0 < Strength < 2\)

where:

\textbf{Specificity} indicates how appropriate is the prevailing social
norm relative to other possible action

\begin{itemize}
\tightlist
\item
  \(NE_{Specificity^+} = \frac{{\sum_{i=1}^{N-1} max(KW)-KW_i}}{(N-1)}\)
  \(\forall KW_i > 0\)
\end{itemize}

We also computed the specificity for inappropriate actions (this is not
used in the computation of norm strenght)

\begin{itemize}
\tightlist
\item
  \(NE_{Specificity^-} = \frac{{\sum_{i=1}^{N-1} max(|KW|)-|KW|_i}}{(N-1)}\)
  \(\forall KW_i < 0\)
\end{itemize}

\textbf{Consistency} indicates what it is the consensus around a
prevailing social norm

\begin{itemize}
\tightlist
\item
  \(NE_{Consistency} = 1- {\sigma_{N} \over max(\sigma_{N})}\)
\end{itemize}

\textbf{Content} indicates the mean appropriateness level of a norm.

\begin{itemize}
\tightlist
\item
  \(E[max_j(KW_j)] \forall j \in A\) where A is the action space
\end{itemize}

\hypertarget{norm-strenght}{%
\paragraph{Norm Strenght}\label{norm-strenght}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ summary(master\$Norm\_Strength)\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Norm\_Strength))\ +\ geom\_histogram(bins\ =\ 7,\ col=I("black"))\ +\ ggtitle("Histogram\ of\ Norm\ Strength")\ +\ xlab("Strength\ Norm")\ +\ facet\_wrap(\textasciitilde{}Game\_type)}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Norm\_Strength,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Norm\_Strength,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\hypertarget{specificity-plus}{%
\paragraph{Specificity plus}\label{specificity-plus}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ summary(master\$specificity\_plus)\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=specificity\_plus))\ +\ geom\_histogram(bins\ =\ 7,\ col=I("black"))\ +\ ggtitle("Histogram\ of\ Specificity\ (positive\ values)")\ +\ xlab("Specificity")\ +\ facet\_wrap(\textasciitilde{}Game\_type)}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=specificity\_plus,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=specificity\_plus,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\hypertarget{consistency}{%
\paragraph{Consistency}\label{consistency}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ summary(master\$consistency)\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=consistency))\ +\ geom\_histogram(bins\ =\ 7,\ col=I("black"))\ +\ ggtitle("Histogram\ of\ Consistency")\ +\ xlab("Consistency")\ +\ facet\_wrap(\textasciitilde{}Game\_type)}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=consistency,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=consistency,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\hypertarget{norm-content}{%
\paragraph{Norm Content}\label{norm-content}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ summary(master\$Avg\_KW\_m)\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Avg\_KW\_m))\ +\ geom\_histogram(bins\ =\ 7,\ col=I("black"))\ +\ ggtitle("Histogram\ of\ Norm\ Content")\ +\ xlab("Norm\ Content")\ +\ facet\_wrap(\textasciitilde{}Game\_type)}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Avg\_KW\_m,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Avg\_KW\_m,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\hypertarget{relation-among-variables}{%
\paragraph{Relation among variables}\label{relation-among-variables}}

** Norm Content and Specificity plus **
\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Avg\_KW\_m,\ y=specificity\_plus))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Avg\_KW\_m,\ y=specificity\_plus))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

** Norm Content and Consistency **
\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Avg\_KW\_m,\ y=consistency))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=Avg\_KW\_m,\ y=consistency))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\hypertarget{delta-vs-spec.-neg.}{%
\paragraph{Delta vs Spec. neg.}\label{delta-vs-spec.-neg.}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=specificity\_min,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ stat\_cor(method\ =\ "spearman")\ \#geom\_text(aes(label=PaperID))\ ggplot(data=master\%\textgreater{}\%\ subset.data.frame(Choice\_Method!="OnlyNorms"),\ aes(x=specificity\_min,\ y=Delta))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")+\ facet\_wrap(\textasciitilde{}Game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\#\ +\ geom\_text(aes(label=PaperID))}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ DG\ \textless{}-\ master\ \%\textgreater{}\%\ subset.data.frame(Game\_type=="DG"\ \&\ Choice\_Method!=\ "OnlyNorms")\ DG\_UG\ \textless{}-\ master\ \%\textgreater{}\%\ subset.data.frame(Game\_type=="DG"\textbar{}Game\_type=="UG")\ UG\ \textless{}-\ master\ \%\textgreater{}\%\ subset.data.frame(Game\_type=="UG"\&\ Choice\_Method!=\ "OnlyNorms")}

\hypertarget{hp3-effect-of-punishment-on-norms-and-actions}{%
\subsection{HP3: Effect of punishment on norms and
actions}\label{hp3-effect-of-punishment-on-norms-and-actions}}

\hypertarget{cooperation-delta-and-strength-comparison-between-dg-and-ug}{%
\subsubsection{Cooperation, Delta and Strength Comparison between DG and
UG}\label{cooperation-delta-and-strength-comparison-between-dg-and-ug}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ hp4\_mean\ \textless{}-\ master\ \%\textgreater{}\%\ \ \ \ subset.data.frame(subset\ =\ Game\_type\ \%in\%\ c("DG",\ "UG")\&Choice\_Method\ !=\ "OnlyNorms")\ \%\textgreater{}\%\ \ \ group\_by(Game\_type)\ \%\textgreater{}\%\ \ \ \ summarise(Coop\ =\ mean(Avg\_coop,\ na.rm\ =\ T),\ \ \ \ \ \ \ \ \ \ \ \ \ \ Avg\_Norm\ =\ mean(Avg\_NE,\ na.rm\ =\ T),\ \ \ \ \ \ \ \ \ \ \ \ \ \ Delta\ =\ mean(Delta,\ na.rm\ =\ T),\ \ \ \ \ \ \ \ \ \ \ \ \ \ Strength\ =\ mean(Norm\_Strength,\ na.rm\ =\ T),\ \ \ \ \ \ \ \ \ \ \ \ \ n\ =\ n())\ \%\textgreater{}\%\ \ \ \ arrange(Game\_type)\ master\_test\ \textless{}-\ master\ \%\textgreater{}\%\ subset.data.frame(select\ =\ c(Game\_type,\ Avg\_coop,\ Avg\_NE,\ Delta,\ Norm\_Strength,\ Macro\_game\_type,\ specificity\_plus,\ specificity\_min,consistency),\ subset\ =\ Game\_type\ \%in\%\ c("DG",\ "UG"))\ wilc\_delta\ =\ wilcox.test(Delta\ \textasciitilde{}\ Game\_type,\ data=master\_test)\ wilc\_strength\ =\ wilcox.test(Norm\_Strength\ \textasciitilde{}\ Game\_type,\ data\ =\ master\_test)\ wilc\_coop\ =\ wilcox.test(Avg\_coop\ \textasciitilde{}\ Game\_type,\ data\ =\ master\_test)\ wilc\_norm\ =\ wilcox.test(Avg\_NE\ \textasciitilde{}\ Game\_type,\ data\ =\ master\_test)\ hp4plus\_mean\ \textless{}-\ hp4\_mean\ \%\textgreater{}\%\ add\_row(Game\_type\ =\ "Difference\ (M.W.W.\ p-value)",\ Coop\ =\ wilc\_coop\$p.value,\ Avg\_Norm\ =\ wilc\_norm\$p.value,\ Delta\ =\ wilc\_delta\$p.value,\ Strength\ =\ wilc\_strength\$p.value)}

We test the hypothesis whether :

\begin{itemize}
\item
  \textbf{Cooperation} (\(Coop_{avg}\)) in DG is lower than UG.

  \begin{itemize}
  \tightlist
  \item
    The p-value of Mann-Whitney-Wilcoxon Test is
    \texttt{r\ round(wilc\_coop\$p.value,\ digits\ =\ 4)}, therefore we
    \emph{can} reject the null hypothesis (at .05 significance level).
  \end{itemize}
\end{itemize}

\begin{itemize}
\item
  \textbf{Delta} in DG is higher than UG.

  \begin{itemize}
  \tightlist
  \item
    The p-value of Mann-Whitney-Wilcoxon Test is
    \texttt{r\ round(wilc\_delta\$p.value,\ digits\ =\ 4)}, therefore we
    \emph{can} reject the null hypothesis (at .05 significance level).
  \end{itemize}
\item
  \textbf{Norm Strength} in DG is higher than UG.

  \begin{itemize}
  \tightlist
  \item
    The p-value of Mann-Whitney-Wilcoxon Test is
    \texttt{r\ round(wilc\_strength\$p.value,\ digits\ =\ 4)}, therefore
    we \emph{can't} reject the null hypothesis (at .05 significance
    level).
  \end{itemize}
\end{itemize}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ opts\ \textless{}-\ options(knitr.kable.NA\ =\ "")\ kbl(hp4plus\_mean,\ digits\ =\ 4,\ booktabs\ =\ T,\ align\ =\ "lccccc",\ centering\ =\ F,\ caption\ =\ "Average\ and\ Mann-Whitney-Wilcoxon\ Test")\ \%\textgreater{}\%\ \ \ kable\_styling(position\ =\ "left",\ full\_width\ =\ F)\ \%\textgreater{}\%\ \ \ column\_spec(1,\ bold\ =\ T)\ \%\textgreater{}\%\ \ \ row\_spec(3,\ bold\ =\ T,\ color\ =\ "white",\ background\ =\ "\#6c757d")}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ \#\ hp4\_sd\ \textless{}-\ master\ \%\textgreater{}\%\ \ \#\ \ \ subset.data.frame(subset\ =\ Macro\_game\_type\ \%in\%\ c("DG\ and\ Donation\ Game",\ "UG"))\ \%\textgreater{}\%\ \#\ \ \ group\_by(Macro\_game\_type)\ \%\textgreater{}\%\ \ \#\ \ \ summarise(Coop\ =\ sd(Avg\_coop,\ na.rm\ =\ T),\ \ \#\ \ \ \ \ \ \ \ \ \ \ \ \ Avg\_Norm\ =\ sd(Avg\_NE,\ na.rm\ =\ T),\ \ \#\ \ \ \ \ \ \ \ \ \ \ \ \ Delta\ =\ sd(Delta,\ na.rm\ =\ T),\ \ \#\ \ \ \ \ \ \ \ \ \ \ \ \ Strength\ =\ sd(Norm\_Strength,\ na.rm\ =\ T),\ \#\ \ \ \ \ \ \ \ \ \ \ \ \ n\ =\ n())\ \%\textgreater{}\%\ \ \#\ \ \ arrange(Macro\_game\_type)\ \#\ \ \#\ opts\ \textless{}-\ options(knitr.kable.NA\ =\ "")\ \#\ kbl(hp4\_sd,\ digits\ =\ 4,\ booktabs\ =\ T,\ align\ =\ "lccccc",\ centering\ =\ F,\ caption\ =\ "Standard\ Deviation")\ \%\textgreater{}\%\ \#\ \ \ kable\_styling(position\ =\ "left",\ full\_width\ =\ F)\ \%\textgreater{}\%\ \#\ \ \ column\_spec(1,\ bold\ =\ T)}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ hp4\_SP\_CS\ \textless{}-\ master\ \%\textgreater{}\%\ \ \ \ subset.data.frame(subset\ =\ Game\_type\ \%in\%\ c("DG",\ "UG"))\ \%\textgreater{}\%\ \ \ group\_by(Game\_type)\ \%\textgreater{}\%\ \ \ \ summarise(Specificity\_plus\ =\ mean(specificity\_plus,\ na.rm\ =\ T),\ Specificity\_min\ =\ mean(specificity\_min,\ na.rm\ =\ T),\ \ \ \ \ \ \ \ \ \ \ \ \ \ Consistency\ =\ mean(consistency,\ na.rm\ =\ T))\ \%\textgreater{}\%\ \ \ \ arrange(Game\_type)\ F\_test\_spec\_plus\ \textless{}-\ wilcox.test(master\_test\$specificity\_plus\ \textasciitilde{}\ master\_test\$Game\_type)\ F\_test\_spec\_min\ \textless{}-\ wilcox.test(master\_test\$specificity\_min\ \textasciitilde{}\ master\_test\$Game\_type)\ F\_test\_cons\ \textless{}-\ wilcox.test(master\_test\$consistency\ \textasciitilde{}\ master\_test\$Game\_type)\ hp4plus\_SP\_CS\ \textless{}-\ hp4\_SP\_CS\ \%\textgreater{}\%\ \ \ \ add\_row(Game\_type\ =\ "Difference\ (Wilcoxon\ p-value)",\ Specificity\_plus\ =\ F\_test\_spec\_plus\$p.value,\ Specificity\_min\ =\ F\_test\_spec\_min\$p.value,\ Consistency\ =\ F\_test\_cons\$p.value)\ opts\ \textless{}-\ options(knitr.kable.NA\ =\ "")\ kbl(hp4plus\_SP\_CS,\ digits\ =\ 4,\ booktabs\ =\ T,\ align\ =\ "lcc",\ centering\ =\ F,\ caption\ =\ "Consistency\ e\ Specificity")\ \%\textgreater{}\%\ \ \ kable\_styling(position\ =\ "left",\ full\_width\ =\ F)\ \%\textgreater{}\%\ \ \ column\_spec(1,\ bold\ =\ T)\ \%\textgreater{}\%\ \ \ row\_spec(3,\ bold\ =\ T,\ color\ =\ "white",\ background\ =\ "\#6c757d")\ \#ggarrange(ggplot(master\_test)\ +\ geom\_density(aes(color\ =\ Game\_type,\ x=specificity)\ +\ xlab("Specificity"),\ \#ggplot(master\_test)\ +\ geom\_density(aes(color\ =\ Game\_type,\ x=consistency))\ +\ xlab("Consistency"),\ common.legend\ =\ T)}

\hypertarget{individual-level-analysis}{%
\section{Individual-level analysis}\label{individual-level-analysis}}

\hypertarget{standard-utility-framework}{%
\subsection{Standard Utility
framework}\label{standard-utility-framework}}

Here we estimate a random utility model using a conditional logit model
(McFadden 1975). We split our individual-level analysis into 2 steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \emph{Within subject design belief elicitation}: we estimate the
  utility function when beliefs and actions are elicited for the same
  subject
\item
  \emph{Between subject design belief elicitation}: we estimate the
  utility function when beliefs and actions are elicited using distinct
  subjects
\end{enumerate}

For 1., the model we estimate is the following:

\(U_{ij} = \alpha \pi_j + \beta S_{ij}\)

while for 2., we use \(S_j=\Sigma S_{ij}/N\) from the external sample
with which social norms were elicited. Hence the model becomes:

\(U_{ij} = \alpha \pi_j + \beta S_{j}\)

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ beliefs\ \textless{}-\ read.csv("../File\_DB/Output/Subjects\_beliefs.csv",\ sep\ =\ ",")\ choices\ \textless{}-\ read.csv("../File\_DB/Output/Subjects\_choices.csv",\ sep\ =\ ",")\ dataframe\_betas\ \textless{}-\ data.frame(ID=NA,\ t=NA,\ game=NA,alpha=NA,\ beta=NA,SE\_alpha=NA,SE\_beta=NA,\ endowment=NA)\ i=0}

\hypertarget{within-subjects-design}{%
\subsubsection{Within-subjects Design}\label{within-subjects-design}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ beliefs\_w\ \textless{}-\ beliefs\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ Design=="Within")\ \#\%\textgreater{}\%\ subset.data.frame(select\ =\ c(paper\_id,treatment\_id,subject\_id,scenarios,KW\_Normative,Game\_type))\ choices\_w\ \textless{}-\ choices\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ Design=="Within")\ \#\%\textgreater{}\%\ subset.data.frame(select\ =\ c(paper\_id,treatment\_id,subject\_id,scenarios,A,choice,Game\_type,\ endowment))\ individual\_db\_w\ \textless{}-\ choices\_w\ \%\textgreater{}\%\ merge.data.frame(beliefs\_w)}

\hypertarget{bas115}{%
\paragraph{2020Bas115}\label{bas115}}

DG - Treatment 1 (``Social'')

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ Bas115\_dg\ =\ individual\_db\_w\ \%\textgreater{}\%\ subset.data.frame(paper\_id=="2020Bas115"\ \&\ Game\_type=="DG")\ \%\textgreater{}\%\ mutate(payoff=endowment-scenarios)\ model\ \textless{}-\ clogit(A\textasciitilde{}\ payoff\ +\ KW\_Normative\ +\ strata(subject\_id),\ data\ =\ Bas115\_dg\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ treatment\_id\ =="2020Bas115\_1a"))\ summary(model)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2020Bas115",1,"DG",model\$coefficients{[}"payoff"{]},model\$coefficients{[}"KW\_Normative"{]},sqrt(model\$var{[}1,1{]}),sqrt(model\$var{[}2,2{]}),\ mean(Bas115\_dg\$endowment))}

DG - Treatment 2 (``Private'')

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ model\ \textless{}-\ clogit(A\textasciitilde{}\ payoff\ +\ KW\_Normative\ +\ strata(subject\_id),\ data\ =\ Bas115\_dg\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ treatment\_id\ =="2020Bas115\_2a"))\ summary(model)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2020Bas115",2,\ "DG",model\$coefficients{[}"payoff"{]},model\$coefficients{[}"KW\_Normative"{]},sqrt(model\$var{[}1,1{]}),sqrt(model\$var{[}2,2{]}),Bas115\_dg\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ treatment\_id\ =="2020Bas115\_2a")\%\textgreater{}\%summarise(e=mean(endowment)))}

UG - Treatment 1 (``Social'')

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ Bas115\_ug\ =\ individual\_db\_w\ \%\textgreater{}\%\ subset.data.frame(paper\_id=="2020Bas115"\ \&\ Game\_type=="UG")\ \%\textgreater{}\%\ mutate(payoff=endowment-scenarios)\ model\ \textless{}-\ clogit(A\textasciitilde{}\ payoff\ +\ KW\_Normative\ +\ strata(subject\_id),\ data\ =\ Bas115\_ug\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ treatment\_id\ =="2020Bas115\_1c"))\ summary(model)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2020Bas115",3,"UG",model\$coefficients{[}"payoff"{]},model\$coefficients{[}"KW\_Normative"{]},sqrt(model\$var{[}1,1{]}),sqrt(model\$var{[}2,2{]}),Bas115\_ug\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ treatment\_id\ =="2020Bas115\_1c")\%\textgreater{}\%summarise(e=mean(endowment)))}

UG - Treatment 2 (``Private'')

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ model\ \textless{}-\ clogit(A\textasciitilde{}\ payoff\ +\ KW\_Normative\ +\ strata(subject\_id),\ data\ =\ Bas115\_ug\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ treatment\_id\ =="2020Bas115\_2c"))\ summary(model)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2020Bas115",4,\ "UG",model\$coefficients{[}"payoff"{]},model\$coefficients{[}"KW\_Normative"{]},sqrt(model\$var{[}1,1{]}),sqrt(model\$var{[}2,2{]}),Bas115\_ug\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ treatment\_id\ =="2020Bas115\_2c")\%\textgreater{}\%summarise(e=mean(endowment)))}

\hypertarget{between-subjects-design}{%
\subsubsection{Between-subjects Design}\label{between-subjects-design}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ beliefs\_temp\ \textless{}-\ beliefs\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ Design=="Between"\&Game\_type=="DG")\ \%\textgreater{}\%\ group\_by(paper\_id,\ scenarios)\ \%\textgreater{}\%\ summarise(KW\_Normative\ =\ mean(KW\_Normative,\ rm.na=T))\ Kim003\_interpolation\ \textless{}-\ beliefs\_temp\ \%\textgreater{}\%\ subset.data.frame(paper\_id\ ==\ "2016Kim003")\ \%\textgreater{}\%\ \ \ \ rbind.data.frame(data.frame(paper\_id="2016Kim003",\ scenarios=seq(1,15,2),\ KW\_Normative=NA))\ \%\textgreater{}\%\ \ \ \ ungroup()\ \%\textgreater{}\%\ arrange(scenarios)\ \%\textgreater{}\%\ \ \ mutate(KW\_Normative\ =\ na.approx(KW\_Normative,\ maxgap\ =\ 1,\ rule\ =\ 1))\ beliefs\_b\ \textless{}-\ beliefs\_temp\ \%\textgreater{}\%\ merge.data.frame(Kim003\_interpolation,\ all\ =\ T)\ choices\_b\ \textless{}-\ choices\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ Design=="Between")\%\textgreater{}\%\ mutate(payoff=endowment-scenarios)\ individual\_db\_b\ \textless{}-\ merge.data.frame(choices\_b,\ beliefs\_b)}

\hypertarget{kim003}{%
\paragraph{2016Kim003}\label{kim003}}

For DG game

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ Kim003\_dg\ =\ individual\_db\_b\ \%\textgreater{}\%\ subset.data.frame(paper\_id=="2016Kim003"\&Game\_type=="DG")\ \%\textgreater{}\%\ mutate(payoff=endowment-scenarios)\ \%\textgreater{}\%\ subset.data.frame(subset\ =\ subject\_id!="2016Kim003\_7\_2222")\ clogit.kim\_dg\ \textless{}-\ clogit(A\textasciitilde{}payoff+KW\_Normative\ +strata(subject\_id),\ data\ =\ Kim003\_dg)\ summary(clogit.kim\_dg)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2016Kim003",1,"DG",clogit.kim\_dg\$coefficients{[}"payoff"{]},clogit.kim\_dg\$coefficients{[}"KW\_Normative"{]},sqrt(clogit.kim\_dg\$var{[}1,1{]}),sqrt(clogit.kim\_dg\$var{[}2,2{]}),mean(Kim003\_dg\$endowment))}

For UG game
\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ Kim003\_ug\ =\ individual\_db\_b\ \%\textgreater{}\%\ subset.data.frame(paper\_id=="2016Kim003"\&Game\_type=="UG")\ \%\textgreater{}\%\ mutate(payoff=endowment-scenarios)\ \%\textgreater{}\%\ subset.data.frame(subject\_id!="2016Kim003\_8\_1804"\ \&\ subject\_id!="2016Kim003\_8\_2411")\ \#mlogit.kim\ \textless{}-\ mlogit(A\textasciitilde{}payoff+KW\_Normative\textbar{}0,\ data\ =\ Kim003\_m)\ \#summary(mlogit.kim)\#\$CoefTable{[}1,2{]}\ \#\#\#\ SUCA\ 2beta/alpha\ monetary\ trade\ off\ from\ -1\ to\ 1\ \ clogit.kim\_ug\ \textless{}-\ clogit(A\textasciitilde{}payoff+KW\_Normative\ +strata(subject\_id),\ data\ =\ Kim003\_ug)\ summary(clogit.kim\_ug)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2016Kim003",2,"UG",clogit.kim\_ug\$coefficients{[}"payoff"{]},clogit.kim\_ug\$coefficients{[}"KW\_Normative"{]},sqrt(clogit.kim\_ug\$var{[}1,1{]}),sqrt(clogit.kim\_ug\$var{[}2,2{]}),mean(Kim003\_ug\$endowment))}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ \#\ Kim003\_m\ \textless{}-\ dfidx(Kim003\_ug\ \%\textgreater{}\%\ mutate(scenarios=as.factor(scenarios)),\ \#\ \ \ \ \ \ \ \ \ \ \ \ \ idx\ =\ c("subject\_id","scenarios"),\ \ \#\ \ \ \ \ \ \ \ \ \ \ \ \ idpkg\ =\ "mlogit")\ \#\ mlogit.kim\ \textless{}-\ mlogit(A\textasciitilde{}payoff+KW\_Normative\textbar{}-1,\ data\ =\ Kim003\_m,\ rpar\ =\ c(KW\_Normative="n",\ payoff="n"))\ \#\ \#summary(mlogit.kim)\#\$CoefTable{[}1,2{]}\ \#\#\#\ SUCA\ 2beta/alpha\ monetary\ trade\ off\ from\ -1\ to\ 1\ \ \#\ mxcl\ \textless{}-\ update(mlogit.kim,\ correlation=T)\ \#\ kw\_n\ \textless{}-\ rpar(mxcl,"KW\_Normative",\ norm="payoff")\ \#\ \#summary(kw\_n)\ \#\ p=fitted(mxcl,type\ =\ "parameters")\ \#\ ggplot(data.frame(betas=p{[},2{]}),\ aes(x=betas))\ +\ geom\_density()}

\hypertarget{her061}{%
\paragraph{2018Her061}\label{her061}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ Her061\ =\ individual\_db\_b\ \%\textgreater{}\%\ subset.data.frame(paper\_id=="2018Her061")\ \%\textgreater{}\%\ mutate(payoff=endowment-scenarios)\ clogit.her\ \textless{}-\ clogit(A\ \textasciitilde{}\ payoff\ +\ KW\_Normative\ +\ strata(subject\_id),\ data=Her061)\ summary(clogit.her)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2018Her061",1,"DG",clogit.her\$coefficients{[}"payoff"{]},clogit.her\$coefficients{[}"KW\_Normative"{]},sqrt(clogit.her\$var{[}1,1{]}),sqrt(clogit.her\$var{[}2,2{]}),mean(Her061\$endowment))}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ \#\ Her061\_m\ \textless{}-\ dfidx(Her061\ \%\textgreater{}\%\ mutate(scenarios=as.factor(scenarios)),\ \#\ \ \ \ \ \ \ \ \ \ \ \ \ idx\ =\ c("subject\_id","scenarios"),\ \ \#\ \ \ \ \ \ \ \ \ \ \ \ \ idpkg\ =\ "mlogit")\ \#\ mlogit.her\ \textless{}-\ mlogit(A\textasciitilde{}\ payoff\ +\ KW\_Normative\textbar{}0,\ data\ =\ Her061\_m,\ rpar\ =\ c(payoff="n",\ KW\_Normative="n"))\ \#\ mxcl\ \textless{}-\ update(mlogit.her,\ correlation=T)\ \#\ kw\_n\ \textless{}-\ rpar(mxcl,"KW\_Normative",\ norm="payoff")\ \#\ summary(mlogit.her)\ \#\ p=fitted(mxcl,type\ =\ "parameters")\ \#\ ggplot(data.frame(betas=p{[},2{]}),\ aes(x=betas))\ +\ geom\_density()\ \#\ mean(data.frame(betas=p{[},2{]})\$betas,\ na.rm\ =\ T)}

\hypertarget{cha026}{%
\paragraph{2019Cha026}\label{cha026}}

Treatment 1

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ Cha026\ =\ individual\_db\_b\ \%\textgreater{}\%\ subset.data.frame(paper\_id=="2019Cha026")\ \%\textgreater{}\%\ mutate(payoff=endowment-scenarios)\ \#Cha026\_m\ \textless{}-\ dfidx(Cha026\ \%\textgreater{}\%\ mutate(scenarios=as.factor(scenarios)),\ \#\ \ \ \ \ \ \ \ \ \ \ \ idx\ =\ c("subject\_id","scenarios"),\ \ \#\ \ \ \ \ \ \ \ \ \ \ \ idpkg\ =\ "mlogit")\ clogit.cha\_1\ \textless{}-\ clogit(A\textasciitilde{}\ payoff\ +\ KW\_Normative\ +\ strata(subject\_id),\ data\ =\ Cha026\%\textgreater{}\%\ subset.data.frame(treatment\_id=="2019Cha026\_1"))\ summary(clogit.cha\_1)\ \#mlogit.cha\ \textless{}-\ mlogit(A\textasciitilde{}\ 0+payoff\ +\ KW\_Normative,\ data\ =\ Cha026\_m)\ \#summary(mlogit.cha)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2019Cha026",1,\ "DG",\ clogit.cha\_1\$coefficients{[}"payoff"{]},clogit.cha\_1\$coefficients{[}"KW\_Normative"{]},sqrt(clogit.cha\_1\$var{[}1,1{]}),sqrt(clogit.cha\_1\$var{[}2,2{]}),mean(Cha026\$endowment))}

Treatment 2

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ clogit.cha\_2\ \textless{}-\ clogit(A\textasciitilde{}\ payoff\ +\ KW\_Normative\ +\ strata(subject\_id),\ data\ =\ Cha026\%\textgreater{}\%\ subset.data.frame(treatment\_id=="2019Cha026\_2"))\ summary(clogit.cha\_2)\ dataframe\_betas{[}i,{]}\ \textless{}-\ c("2019Cha026",2,\ "DG",\ clogit.cha\_2\$coefficients{[}"payoff"{]},clogit.cha\_2\$coefficients{[}"KW\_Normative"{]},sqrt(clogit.cha\_2\$var{[}1,1{]}),sqrt(clogit.cha\_2\$var{[}2,2{]}),\ Cha026\%\textgreater{}\%\ subset.data.frame(treatment\_id=="2019Cha026\_2")\%\textgreater{}\%\ summarise(e=mean(endowment)))}

\hypertarget{all-papers-results}{%
\subsubsection{All papers results}\label{all-papers-results}}

```\{r echo=F, message=FALSE, warning=FALSE\} allpaperdata \textless-
dataframe\_betas \%\textgreater\% mutate\_at(.vars =
vars(alpha:SE\_beta), as.numeric) \%\textgreater\% mutate(MRS =
2\emph{as.numeric(beta)/as.numeric(alpha)) averages \textless-
allpaperdata \%\textgreater\% summarise\_at(.vars =
vars(alpha:SE\_beta), mean) allpaperdata \textless- allpaperdata
\%\textgreater\% add\_row(ID=``Average'',t= ````,game=''``,
alpha=averages\(alpha, beta=averages\)beta,
SE\_alpha=averages\(SE_alpha, SE_beta=averages\)SE\_beta,
MRS=2}averages\(beta/averages\)alpha)

opts \textless- options(knitr.kable.NA = ````) kbl(allpaperdata, digits
= 2, booktabs = T, align =''lccccc'', centering = F, caption =
``Estimated Parameters'') \%\textgreater\% kable\_styling(position =
``left'', full\_width = F) \%\textgreater\% column\_spec(1, bold = T)
ggplot(allpaperdata \%\textgreater\% mutate(uniqueID=paste(ID,t,sep =
``\_t'')) \%\textgreater\% arrange(beta),
aes(x=beta,y=uniqueID,color=ID)) + geom\_point() +
geom\_errorbar(aes(xmin=beta-2\emph{SE\_beta,xmax=beta+2}SE\_beta))

\begin{verbatim}
## Augmented Utility framework {.tabset}

Here we augment the standard utility framework by including a measure of norm specificity either at the individual level and at the choice level depending on the nature of the data (between-subject elicitation or within-subject elicitation).


<center>
$U_{ij} = \alpha \pi_j + \beta S_{ij} + \eta S_{ij}*\sigma_i(S_{ij})$ 
</center>

where $\sigma(\cdot)$ is the standard deviation of $S_{ij}$ representing uncertainty around the norm.


<center>
$U_{ij} = \alpha \pi_j + \beta S_{j} + \eta S_{j}*\sigma_j(S_{ij})$ 
</center>


### Within-subjects elicitation {.tabset}

#### 2020Bas115

DG - T1
```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment=""}
i=1
SDi= Bas115_dg %>% group_by(subject_id) %>% summarise(sdi=sd(KW_Normative))
Bas115_dg <- Bas115_dg %>% merge.data.frame(SDi)
model <- clogit(A~ payoff + KW_Normative+ KW_Normative:sdi + strata(subject_id), data = Bas115_dg%>% subset.data.frame(subset = treatment_id=="2020Bas115_1a"))
summary(model)
dataframe_betas_augmented <- data.frame(ID="2020Bas115",t=1,game_type="DG",alpha=model$coefficients["payoff"],
                                        beta=model$coefficients["KW_Normative"],
                                        gamma=model$coefficients["KW_Normative:sdi"],
                                        SE_alpha=sqrt(model$var[1,1]),
                                        SE_beta=sqrt(model$var[2,2]),
                                        SE_gamma=sqrt(model$var[3,3]), row.names = NULL
                                        )
\end{verbatim}

DG - T2
\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ model\ \textless{}-\ clogit(A\textasciitilde{}\ payoff\ +\ KW\_Normative+\ KW\_Normative:sdi\ +\ strata(subject\_id),\ data\ =\ Bas115\_dg\%\textgreater{}\%\ subset.data.frame(subset\ =\ treatment\_id=="2020Bas115\_2a"))\ summary(model)\ dataframe\_betas\_augmented{[}i,{]}\ \textless{}-\ c(ID="2020Bas115",t=2,game\_type="DG",alpha=model\$coefficients{[}"payoff"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta=model\$coefficients{[}"KW\_Normative"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma=model\$coefficients{[}"KW\_Normative:sdi"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_alpha=sqrt(model\$var{[}1,1{]}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_beta=sqrt(model\$var{[}2,2{]}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_gamma=sqrt(model\$var{[}3,3{]})\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}

\hypertarget{between-subjects-elicitation}{%
\subsubsection{Between-subjects
elicitation}\label{between-subjects-elicitation}}

\hypertarget{kim003-1}{%
\paragraph{2016Kim003}\label{kim003-1}}

DG game
\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ SDj=\ beliefs\ \%\textgreater{}\%\ group\_by(paper\_id,\ treatment\_id,\ scenarios)\ \%\textgreater{}\%\ summarise(sdj=sd(KW\_Normative))\ i=i+1\ Kim003\_dg\ =\ Kim003\_dg\ \%\textgreater{}\%\ merge.data.frame(SDj)\ model\ \textless{}-\ clogit(A\textasciitilde{}payoff+KW\_Normative\ +\ KW\_Normative:sdj\ +\ strata(subject\_id),\ data\ =\ Kim003\_dg)\ summary(model)\ dataframe\_betas\_augmented{[}i,{]}\ \textless{}-\ c(ID="2016Kim003",t=1,game\_type="DG",\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha=model\$coefficients{[}"payoff"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta=model\$coefficients{[}"KW\_Normative"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma=model\$coefficients{[}"KW\_Normative:sdi"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_alpha=sqrt(model\$var{[}1,1{]}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_beta=sqrt(model\$var{[}2,2{]}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_gamma=sqrt(model\$var{[}3,3{]}))}

For UG game
\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ SDj=\ Kim003\_ug\ \%\textgreater{}\%\ group\_by(scenarios)\ \%\textgreater{}\%\ summarise(sdj=sd(KW\_Normative))\ Kim003\_ug\ =\ Kim003\_ug\ \%\textgreater{}\%\ merge.data.frame(SDj)\ model\ \textless{}-\ clogit(A\textasciitilde{}payoff+KW\_Normative\ +\ KW\_Normative*sdj\ +\ strata(subject\_id),\ data\ =\ Kim003\_ug)\ summary(model)\ dataframe\_betas\_augmented{[}i,{]}\ \textless{}-\ c(ID="2016Kim003",t=2,game\_type="UG",alpha=model\$coefficients{[}"payoff"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ beta=model\$coefficients{[}"KW\_Normative"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gamma=model\$coefficients{[}"KW\_Normative:sdi"{]},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_alpha=sqrt(model\$var{[}1,1{]}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_beta=sqrt(model\$var{[}2,2{]}),\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SE\_gamma=sqrt(model\$var{[}3,3{]}))}

\hypertarget{individual-analysis-of-norm-compliance}{%
\subsection{Individual analysis of norm
compliance}\label{individual-analysis-of-norm-compliance}}

\hypertarget{bas155}{%
\subsubsection{bas155}\label{bas155}}

bas115\_strenght \textless- Bas115 \%\textgreater\%
group\_by(subject\_id) \%\textgreater\% summarise(specificity =
sd(KW\_Normative)) data\_bas115 \textless- Bas115 \%\textgreater\%
merge.data.frame(bas115\_strenght) data\_bas115\_m \textless-
dfidx(data\_bas115 \%\textgreater\%
mutate(scenarios=as.factor(scenarios)), idx =
c(``subject\_id'',``scenarios''), idpkg = ``mlogit'') summary(mlogit(A
\textasciitilde{} payoff \textbar KW\_Normative\textbar specificity ,
data=data\_bas115\_m))

\hypertarget{appendix}{%
\section{Appendix}\label{appendix}}

\hypertarget{effect-of-varibility-on-norms-and-actions}{%
\subsection{Effect of varibility on norms and
actions}\label{effect-of-varibility-on-norms-and-actions}}

\begin{itemize}
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi}.}
  \tightlist
  \item
    Does a higher norm variability lead to lower cooperation?
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{\alph{enumi}.}
  \setcounter{enumi}{1}
  \tightlist
  \item
    Does a higher norm variability lead to higher cooperation variance?
  \end{enumerate}
\end{itemize}

to do so we computed VAR\_NE (\(NE_{var}\)) as:

\[ NE_{var} = \sigma^2_{i}(max\{\mu_j(NE)\}) \]

a. Does a higher norm variability lead to lower cooperation?

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ cor.test(master\$Var\_NE,\ master\$Avg\_coop,\ method=\ "spearman",\ exact\ =\ F)\ ggplot(data=master,\ aes(x=Var\_NE,\ y=Avg\_coop))\ +\ geom\_point()\ +\ geom\_smooth(method="lm")\ +\ ggtitle("Fig.\ 3\ H2a\ :\ Correlation\ Between\ Average\ Cooperation\ and\ Norm\ Variance\ (NE)")\ +\ stat\_cor(method\ =\ "spearman")\ \ ggplot(data=master,\ aes(x=Var\_NE,\ y=Avg\_coop))\ +\ geom\_point()\ +\ ggtitle("Fig.\ 4\ H2a\ :\ Correlation\ Between\ Average\ Cooperation\ and\ Norm\ Variance\ (NE)")\ +\ facet\_wrap(\textasciitilde{}Macro\_game\_type,\ ncol=3)\ +\ stat\_cor(method\ =\ "spearman")\ +\ geom\_smooth(method="lm")}

b. Does a higher norm variability lead to higher cooperation var.?

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ cor.test(master\$Var\_NE,\ master\$Var\_coop,\ method=\ "spearman",\ exact\ =\ F)\ ggplot(data=master,\ aes(x=Var\_NE,\ y=Var\_coop))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ ggtitle("Fig.\ 5\ H2b\ :\ Correlation\ Between\ Variance\ Cooperation\ and\ Norm\ (NE)")\ ggplot(data=master,\ aes(x=Var\_NE,\ y=Var\_coop))\ +\ geom\_point()\ +\ geom\_smooth(method\ =\ "lm")\ +\ ggtitle("Fig.\ 6\ H2b\ :\ Correlation\ Between\ Variance\ Cooperation\ and\ Norm\ (NE)")\ +\ facet\_wrap(\textasciitilde{}Macro\_game\_type)\ +\ stat\_cor(method\ =\ "spearman")}

\hypertarget{papers-included}{%
\subsection{Papers included}\label{papers-included}}

\texttt{\{r\ echo=F\}\ n\_subjects\_choice\ \textless{}-\ choices\ \%\textgreater{}\%\ subset.data.frame(A==1)\ \%\textgreater{}\%\ group\_by(paper\_id,\ treatment\_id)\ \%\textgreater{}\%\ summarise(N\_choices=length(A))\ \%\textgreater{}\%\ rename(PaperID=paper\_id)\ \%\textgreater{}\%\ mutate(TreatmentCode=str\_split\_fixed(treatment\_id,"\_",2){[},2{]})\ \%\textgreater{}\%\ subset.data.frame(select\ =\ -c(treatment\_id))\ n\_subjects\_beliefs\ \textless{}-\ beliefs\ \%\textgreater{}\%\ group\_by(subject\_id)\ \%\textgreater{}\%\ filter(row\_number()==1)\%\textgreater{}\%group\_by(paper\_id,\ treatment\_id)\ \%\textgreater{}\%\ summarise(N\_beliefs=length(scenarios))\%\textgreater{}\%\ rename(PaperID=paper\_id)\ \%\textgreater{}\%\ mutate(TreatmentCode=str\_split\_fixed(treatment\_id,"\_",2){[},2{]})\ \%\textgreater{}\%\ subset.data.frame(select\ =\ -c(treatment\_id))\ list\_of\_paper\ \textless{}-\ master\ \%\textgreater{}\%\ \ \ \ mutate(data\_type\ =\ ifelse(is.na(Avg\_NE),\ "Actions",\ ifelse(is.na(Avg\_coop),\ "Norms",\ "Both")))\ \%\textgreater{}\%\ \ \ \ group\_by(data\_type,\ PaperID,\ TreatmentCode,\ Game\_type,\ Method\_elicitation,\ Separate\_sample\_beliefs,\ Standard\_game)\ \%\textgreater{}\%\ \ \ \ summarise(n\_treatments\ =\ n())\ \%\textgreater{}\%\ merge.data.frame(n\_subjects\_choice,\ all.x\ =\ T)\ \%\textgreater{}\%\ merge.data.frame(n\_subjects\_beliefs,\ all.x\ =\ T)\ opts\ \textless{}-\ options(knitr.kable.NA\ =\ "")\ kbl(list\_of\_paper,\ digits\ =\ 4,\ booktabs\ =\ T,\ align\ =\ "lcccccc",\ centering\ =\ F,\ caption\ =\ "Ciao")\ \%\textgreater{}\%\ \ \ kable\_styling(position\ =\ "left",\ full\_width\ =\ F)\ \%\textgreater{}\%\ \ \ column\_spec(1,\ bold\ =\ T)\ datatable(master\ \%\textgreater{}\%\ subset.data.frame(select\ =\ c(PaperID,\ TreatmentCode,\ Game\_type,\ Avg\_coop,\ SD\_NE,\ Sd\_Avg\_NE,\ Norm\_Strength,\ Delta)),rownames\ =\ F)\ \%\textgreater{}\%\ formatRound(columns\ =\ c("Avg\_coop",\ "Avg\_coop",\ "SD\_NE",\ "Sd\_Avg\_NE",\ "Norm\_Strength",\ "Delta"),\ digits\ =\ 2)}

\hypertarget{conditional-logit-model-overall-model}{%
\subsection{Conditional logit model (Overall
model)}\label{conditional-logit-model-overall-model}}

\texttt{\{r\ echo=FALSE,\ message=FALSE,\ warning=FALSE,\ cache=FALSE,\ comment=""\}\ i=i+1\ between\ \textless{}-clogit(A\textasciitilde{}\ payoff*paper\_id\ +\ KW\_Normative*paper\_id\ +\ strata(subject\_id),\ data\ =\ individual\_db\_b)\ summary(between)\ \#dataframe\_betas{[}i,{]}\ \textless{}-\ c("Avg.\ Between",between\$coefficients{[}"payoff"{]},between\$coefficients{[}"KW\_Normative"{]},between\$var{[}1,1{]},between\$var{[}2,2{]})}

\hypertarget{comparison-of-avg_kw_m-per-paper}{%
\subsection{Comparison of Avg\_kw\_m per
paper}\label{comparison-of-avg_kw_m-per-paper}}

```\{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE,
comment=````\} setwd(''../``) setwd(''Paper\_csv/``) getwd() df\_avg\_kw
\textless- read.csv(''2015Ves034\_avg\_kw.csv'', sep = ``,'')

df\_avg\_kw \textless- read.csv(``2016Kim003\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2017Del037\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2017Tho028\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2017Ves049\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2018Her061\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2019Cha026\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2019Dro082\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2019Tjo060\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2020And089\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2020Bas115\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

df\_avg\_kw \textless- read.csv(``2021Kon127\_avg\_kw.csv'', sep =
``,'') \%\textgreater\% rbind.data.frame(df\_avg\_kw)

\begin{verbatim}

```{r echo=FALSE, message=FALSE, warning=FALSE, cache=FALSE, comment=""}
temp_master <- df_avg_kw %>% distinct(PaperID)

for (i in temp_master$PaperID) {
 temp_master_for <- df_avg_kw %>% filter(PaperID == i)
  print(ggplot(temp_master_for, aes(x=donation, y=Kw_m)) + geom_bar(stat = "identity") + labs(title = i) + facet_wrap(~TreatmentCode, ncol = 2))
}
\end{verbatim}
