p=fitted(mxcl,type = "parameters")
#summary(kw_n)
p=fitted(mxcl,type = "parameters")
ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
Kim003_ug = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003"&Game_type=="UG") %>% mutate(payoff=endowment-scenarios)
#mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
#summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
clogit.kim_ug <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003_ug)
summary(clogit.kim_ug)
Kim003_m <- dfidx(Kim003_ug %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.kim <- mlogit(A~payoff+KW_Normative|-1, data = Kim003_m, rpar = c(KW_Normative="n", payoff="n"))
mlogit.kim <- mlogit(A~payoff+KW_Normative|-1, data = Kim003_m)
View(Kim003_ug)
Kim003_ug%>% group_by(subject_id) %>% summarise(A=sum(A))
View(Kim003_ug%>% group_by(subject_id) %>% summarise(A=sum(A)))
Kim003_ug = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003"&Game_type=="UG") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subject_id!="2016Kim003_8_1804" & subject_id!="2016Kim003_8_2411")
Kim003_m <- dfidx(Kim003_ug %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.kim <- mlogit(A~payoff+KW_Normative|-1, data = Kim003_m, rpar = c(KW_Normative="n", payoff="n"))
#summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
mxcl <- update(mlogit.kim, correlation=T)
#summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
mxcl <- update(mlogit.kim, correlation=T)
kw_n <- rpar(mxcl,"KW_Normative", norm="payoff")
#summary(kw_n)
p=fitted(mxcl,type = "parameters")
ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
Her061_m <- dfidx(Her061 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
Her061 = individual_db_b %>% subset.data.frame(paper_id=="2018Her061") %>% mutate(payoff=endowment-scenarios)
clogit.her <- clogit(A ~ payoff + KW_Normative + strata(subject_id), data=Her061)
summary(clogit.her)
Her061_m <- dfidx(Her061 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m)
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m, rpar = c(payoff="n", KW_Normative="n"))
mxcl <- update(mlogit.her, correlation=T)
kw_n <- rpar(mxcl,"KW_Normative", norm="payoff")
#summary(kw_n)
p=fitted(mxcl,type = "parameters")
ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
summary(kw_n)
mxcl
mxcl <- update(mlogit.her, correlation=T)
kw_n <- rpar(mxcl,"KW_Normative", norm="payoff")
#summary(kw_n)
p=fitted(mxcl,type = "parameters")
ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
mlogit.her
#summary(kw_n)
p=fitted(mlogit.her,type = "parameters")
ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m, rpar = c(payoff="n", KW_Normative="n"))
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m, rpar = c(payoff="n", KW_Normative="n"))
mxcl <- update(mlogit.her, correlation=T)
kw_n
str(mxcl)
mean(mxcl)
mean(kw_n)
#summary(kw_n)
p=fitted(mxcl,type = "parameters")
ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
mean(data.frame(betas=p[,2]))
data.frame(betas=p[,2])
mean(data.frame(betas=p[,2]), na.rm = T)
mean(data.frame(betas=p[,2])$betas, na.rm = T)
mean(data.frame(betas=p[,1])$betas, na.rm = T)
summary(kw_n)
#summary(mxcl)
p=fitted(mxcl,type = "parameters")
#
summary(mxcl)
summary(mlogit.her)
Kim003_m <- dfidx(Kim003_ug %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.kim <- mlogit(A~payoff+KW_Normative|-1, data = Kim003_m, rpar = c(KW_Normative="n", payoff="n"))
#summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
mxcl <- update(mlogit.kim, correlation=T)
kw_n <- rpar(mxcl,"KW_Normative", norm="payoff")
#summary(kw_n)
p=fitted(mxcl,type = "parameters")
ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta)
)
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type), SD_NE=sqrt(Var_NE)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = Sd_Avg_NE
# consistency = sqrt(Var_NE)
master = master %>% mutate(Norm_Strength = 1/sqrt(Var_NE) + 1/Sd_Avg_NE,
Delta = (Avg_NE-Avg_coop))
summary(master$Norm_Strength)
ggplot(data=master, aes(x=Norm_Strength)) +
geom_histogram() + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Macro_game_type)
cor.test(master$Norm_Strength, master$Delta, method= "spearman", exact = F)
ggplot(data=master, aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman")
ggplot(data=master, aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG")
hp4_mean <- master %>%
subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")&Choice_Method != "OnlyNorms") %>%
group_by(Macro_game_type) %>%
summarise(Coop = mean(Avg_coop, na.rm = T),
Avg_Norm = mean(Avg_NE, na.rm = T),
Delta = mean(Delta, na.rm = T),
Strength = mean(Norm_Strength, na.rm = T),
n = n()) %>%
arrange(Macro_game_type)
master_test <- master %>% subset.data.frame(select = c(Game_type, Avg_coop, Avg_NE, Delta, Norm_Strength, Macro_game_type, Sd_Avg_NE, Var_NE), subset = Game_type %in% c("DG", "UG"))
wilc_delta = wilcox.test(Delta ~ Macro_game_type, data=master_test)
wilc_strength = wilcox.test(Norm_Strength ~ Macro_game_type, data = master_test)
wilc_coop = wilcox.test(Avg_coop ~ Macro_game_type, data = master_test)
wilc_norm = wilcox.test(Avg_NE ~ Macro_game_type, data = master_test)
hp4plus_mean <- hp4_mean %>% add_row(Macro_game_type = "Difference (Wilcoxon p-value)", Coop = wilc_coop$p.value, Avg_Norm = wilc_norm$p.value, Delta = wilc_delta$p.value, Strength = wilc_strength$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_mean, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Average and Mann-Whitney-Wilcoxon Test") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
# hp4_sd <- master %>%
#   subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
#   group_by(Macro_game_type) %>%
#   summarise(Coop = sd(Avg_coop, na.rm = T),
#             Avg_Norm = sd(Avg_NE, na.rm = T),
#             Delta = sd(Delta, na.rm = T),
#             Strength = sd(Norm_Strength, na.rm = T),
#             n = n()) %>%
#   arrange(Macro_game_type)
#
# opts <- options(knitr.kable.NA = "")
# kbl(hp4_sd, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Standard Deviation") %>%
#   kable_styling(position = "left", full_width = F) %>%
#   column_spec(1, bold = T)
hp4_SP_CS <- master %>%
subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
group_by(Macro_game_type) %>%
summarise(Specificity = mean(1/(Sd_Avg_NE), na.rm = T),
Consistency = mean(1/(sqrt(Var_NE)), na.rm = T)) %>%
arrange(Macro_game_type)
F_test_spec <- wilcox.test(1/(master_test$Sd_Avg_NE) ~ master_test$Macro_game_type)
F_test_cons <- wilcox.test(1/(sqrt(master_test$Var_NE)) ~ master_test$Macro_game_type)
hp4plus_SP_CS <- hp4_SP_CS %>%
add_row(Macro_game_type = "Difference (Wilcoxon p-value)", Specificity = F_test_spec$p.value, Consistency = F_test_cons$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_SP_CS, digits = 4, booktabs = T, align = "lcc", centering = F, caption = "Consistency e Specificity") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/Sd_Avg_NE))) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
i=i+1
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_1a"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",1,"DG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_2a"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",2, "DG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
Bas115_ug = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="UG") %>% mutate(payoff=endowment-scenarios)
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_1c"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",3,"UG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_2c"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",4, "UG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
i=i+1
Kim003_dg = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003"&Game_type=="DG") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
clogit.kim_dg <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003_dg)
summary(clogit.kim_dg)
dataframe_betas[i,] <- c("2016Kim003",1,"DG",clogit.kim_dg$coefficients["payoff"],clogit.kim_dg$coefficients["KW_Normative"],sqrt(clogit.kim_dg$var[1,1]),sqrt(clogit.kim_dg$var[2,2]))
i=i+1
Kim003_ug = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003"&Game_type=="UG") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subject_id!="2016Kim003_8_1804" & subject_id!="2016Kim003_8_2411")
#mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
#summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
clogit.kim_ug <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003_ug)
summary(clogit.kim_ug)
dataframe_betas[i,] <- c("2016Kim003",2,"UG",clogit.kim_ug$coefficients["payoff"],clogit.kim_ug$coefficients["KW_Normative"],sqrt(clogit.kim_ug$var[1,1]),sqrt(clogit.kim_ug$var[2,2]))
# Kim003_m <- dfidx(Kim003_ug %>% mutate(scenarios=as.factor(scenarios)),
#             idx = c("subject_id","scenarios"),
#             idpkg = "mlogit")
# mlogit.kim <- mlogit(A~payoff+KW_Normative|-1, data = Kim003_m, rpar = c(KW_Normative="n", payoff="n"))
# #summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
# mxcl <- update(mlogit.kim, correlation=T)
# kw_n <- rpar(mxcl,"KW_Normative", norm="payoff")
# #summary(kw_n)
# p=fitted(mxcl,type = "parameters")
# ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
i=i+1
Her061 = individual_db_b %>% subset.data.frame(paper_id=="2018Her061") %>% mutate(payoff=endowment-scenarios)
clogit.her <- clogit(A ~ payoff + KW_Normative + strata(subject_id), data=Her061)
summary(clogit.her)
dataframe_betas[i,] <- c("2018Her061",1,"DG",clogit.her$coefficients["payoff"],clogit.her$coefficients["KW_Normative"],sqrt(clogit.her$var[1,1]),sqrt(clogit.her$var[2,2]))
# Her061_m <- dfidx(Her061 %>% mutate(scenarios=as.factor(scenarios)),
#             idx = c("subject_id","scenarios"),
#             idpkg = "mlogit")
# mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m, rpar = c(payoff="n", KW_Normative="n"))
# mxcl <- update(mlogit.her, correlation=T)
# kw_n <- rpar(mxcl,"KW_Normative", norm="payoff")
# summary(mlogit.her)
# p=fitted(mxcl,type = "parameters")
# ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
# mean(data.frame(betas=p[,2])$betas, na.rm = T)
i=i+1
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
#Cha026_m <- dfidx(Cha026 %>% mutate(scenarios=as.factor(scenarios)),
#            idx = c("subject_id","scenarios"),
#            idpkg = "mlogit")
clogit.cha_1 <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Cha026%>% subset.data.frame(treatment_id=="2019Cha026_1"))
summary(clogit.cha_1)
#mlogit.cha <- mlogit(A~ 0+payoff + KW_Normative, data = Cha026_m)
#summary(mlogit.cha)
dataframe_betas[i,] <- c("2019Cha026",1, "DG", clogit.cha_1$coefficients["payoff"],clogit.cha_1$coefficients["KW_Normative"],sqrt(clogit.cha_1$var[1,1]),sqrt(clogit.cha_1$var[2,2]))
i=i+1
clogit.cha_2 <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Cha026%>% subset.data.frame(treatment_id=="2019Cha026_2"))
summary(clogit.cha_2)
dataframe_betas[i,] <- c("2019Cha026",2, "DG", clogit.cha_2$coefficients["payoff"],clogit.cha_2$coefficients["KW_Normative"],sqrt(clogit.cha_2$var[1,1]),sqrt(clogit.cha_2$var[2,2]))
dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta))
dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric)
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric), aes(x=beta,y=ID))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric), aes(x=beta,y=ID)) + geom_point()
dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric)
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric), aes(x=beta,y=ID)) + geom_pointrange(aes(ymin=beta-2*SE_beta,ymax=beta+2*SE_beta))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric), aes(x=beta,y=ID)) + geom_point() + geom_pointrange(aes(ymin=beta-2*SE_beta,ymax=beta+2*SE_beta))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric), aes(x=beta,y=ID)) + geom_point() + geom_errorbar(aes(ymin=beta-2*SE_beta,ymax=beta+2*SE_beta))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric), aes(x=beta,y=ID)) + geom_point() + geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>% mutate(uniqueID=paste(ID,t,sep = "")), aes(x=beta,y=uniqueID)) + geom_point() + geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>% mutate(uniqueID=paste(ID,t,sep = "")) %>% arrange(beta), aes(x=beta,y=uniqueID)) +
geom_point() + geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>% mutate(uniqueID=paste(ID,t,sep = "")) %>% arrange(beta)
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>% mutate(uniqueID=paste(ID,t,sep = "")) %>% arrange(beta), aes(x=beta,y=uniqueID)) +
geom_point() + geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>% mutate(uniqueID=paste(ID,t,sep = "")) %>% arrange(beta), aes(x=alpha,y=uniqueID)) +
geom_point() + geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>% mutate(uniqueID=paste(ID,t,sep = "")) %>% arrange(beta), aes(x=beta,y=uniqueID)) +
geom_point() +
geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>% mutate(uniqueID=paste(ID,t,sep = "")) %>% arrange(beta), aes(x=beta,y=uniqueID,color=ID)) +
geom_point() +
geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)) %>% add_row(ID="Average",t= "",game="", alpha=mean(alpha), beta=mean(beta), SE_alpha=NA, SE_beta=NA, MRS=2*mean(beta)/mean(alpha))
allpaperdata
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)) %>% add_row(ID="Average",t= "",game="X", alpha=mean(alpha), beta=mean(beta), SE_alpha=NA, SE_beta=NA, MRS=2*mean(beta)/mean(alpha))
allpaperdata
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)) %>% add_row(ID="Average",t= "",game="", alpha=mean(allpaperdata$alpha), beta=mean(beta), SE_alpha=NA, SE_beta=NA, MRS=2*mean(beta)/mean(alpha))
allpaperdata
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)) %>%
add_row(ID="Average",t= "",game="", alpha=mean(as.numeric(alpha)), beta=mean(beta), SE_alpha=NA, SE_beta=NA, MRS=2*mean(beta)/mean(alpha))
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)) %>%
add_row(ID="Average",t= "",game="", alpha=mean(alpha), beta=mean(beta), SE_alpha=NA, SE_beta=NA, MRS=2*mean(beta)/mean(alpha))
allpaperdata
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)) %>%
add_row(ID="Average",t= "",game="", alpha=mean(alpha, na.rm = T), beta=mean(beta), SE_alpha=NA, SE_beta=NA, MRS=2*mean(beta)/mean(alpha))
allpaperdata
averages <- allpaperdata %>% summarise_at(.vars = vars(alpha:SE_beta))
averages <- allpaperdata %>% summarise_at(.vars = vars(alpha:SE_beta), mean)
averages
allpaperdata
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha))
allpaperdata
averages <- allpaperdata %>% summarise_at(.vars = vars(alpha:SE_beta), mean)
averages
allpaperdata %>% add_row(ID="Average",t= "",game="", alpha=averages$alpha, beta=averages$beta, SE_alpha=averages$SE_alpha, SE_beta=averages$SE_beta, MRS=2*averages$beta/averages$alpha)
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha))
averages <- allpaperdata %>% summarise_at(.vars = vars(alpha:SE_beta), mean)
allpaperdata <- allpaperdata %>% add_row(ID="Average",t= "",game="", alpha=averages$alpha, beta=averages$beta, SE_alpha=averages$SE_alpha, SE_beta=averages$SE_beta, MRS=2*averages$beta/averages$alpha)
opts <- options(knitr.kable.NA = "")
kbl(allpaperdata, digits = 2, booktabs = T, align = "lccccc", centering = F, caption = "Estimated Parameters") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T)
ggplot(dataframe_betas %>% mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>% mutate(uniqueID=paste(ID,t,sep = "_t")) %>% arrange(beta), aes(x=beta,y=uniqueID,color=ID)) +
geom_point() +
geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
kbl(allpaperdata, digits = 2, booktabs = T, align = "lccccc", centering = F, caption = "Estimated Parameters") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T)
ggplot(allpaperdata) %>% mutate(uniqueID=paste(ID,t,sep = "_t")) %>% arrange(beta), aes(x=beta,y=uniqueID,color=ID)) +
ggplot(allpaperdata %>% mutate(uniqueID=paste(ID,t,sep = "_t")) %>% arrange(beta), aes(x=beta,y=uniqueID,color=ID)) +
geom_point() +
geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
ggplot(allpaperdata %>% mutate(uniqueID=paste(ID,t,sep = "_t")) %>% arrange(beta), aes(x=beta,y=uniqueID,group=ID)) +
geom_point() +
geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
ggplot(allpaperdata %>% mutate(uniqueID=paste(ID,t,sep = "_t")) %>% arrange(beta), aes(x=beta,y=uniqueID,color=ID)) +
geom_point() +
geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
beliefs
View(beliefs)
View(choices)
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type), SD_NE=sqrt(Var_NE)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
View(beliefs)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
View(beliefs)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
table(beliefs_w$paper_id)
table(choices_w$paper_id)
bid=beliefs_w$subject_id
choicesid=levels(as.factor(choices_w$subject_id))
bid=levels(as.factor(beliefs_w$subject_id))
!(bid %in% choicesid)
bid[!(bid %in% choicesid)]
bid[!(choicesid %in% bid)]
choicesid[!(choicesid %in% bid)]
View(beliefs_w)
View(choices_w)
22*250
beliefs %>% subset.data.frame(subset = Design=="Between")
choices %>% subset.data.frame(subset = Design=="Between")
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
beliefs_b
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
individual_db_w
beliefs_w
choices_w
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
individual_db_w
beliefs_w
choices_w
65*11
65*22
1375/22
1375/11
1353/11
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
View(beliefs)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
View(beliefs)
View(choices)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type), SD_NE=sqrt(Var_NE)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = Sd_Avg_NE
# consistency = sqrt(Var_NE)
master = master %>% mutate(Norm_Strength = 1/sqrt(Var_NE) + 1/Sd_Avg_NE,
Delta = (Avg_NE-Avg_coop))
summary(master$Norm_Strength)
ggplot(data=master, aes(x=Norm_Strength)) +
geom_histogram() + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Macro_game_type)
cor.test(master$Norm_Strength, master$Delta, method= "spearman", exact = F)
ggplot(data=master, aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman")
ggplot(data=master, aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG")
hp4_mean <- master %>%
subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")&Choice_Method != "OnlyNorms") %>%
group_by(Macro_game_type) %>%
summarise(Coop = mean(Avg_coop, na.rm = T),
Avg_Norm = mean(Avg_NE, na.rm = T),
Delta = mean(Delta, na.rm = T),
Strength = mean(Norm_Strength, na.rm = T),
n = n()) %>%
arrange(Macro_game_type)
master_test <- master %>% subset.data.frame(select = c(Game_type, Avg_coop, Avg_NE, Delta, Norm_Strength, Macro_game_type, Sd_Avg_NE, Var_NE), subset = Game_type %in% c("DG", "UG"))
wilc_delta = wilcox.test(Delta ~ Macro_game_type, data=master_test)
wilc_strength = wilcox.test(Norm_Strength ~ Macro_game_type, data = master_test)
wilc_coop = wilcox.test(Avg_coop ~ Macro_game_type, data = master_test)
wilc_norm = wilcox.test(Avg_NE ~ Macro_game_type, data = master_test)
hp4plus_mean <- hp4_mean %>% add_row(Macro_game_type = "Difference (Wilcoxon p-value)", Coop = wilc_coop$p.value, Avg_Norm = wilc_norm$p.value, Delta = wilc_delta$p.value, Strength = wilc_strength$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_mean, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Average and Mann-Whitney-Wilcoxon Test") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
# hp4_sd <- master %>%
#   subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
#   group_by(Macro_game_type) %>%
#   summarise(Coop = sd(Avg_coop, na.rm = T),
#             Avg_Norm = sd(Avg_NE, na.rm = T),
#             Delta = sd(Delta, na.rm = T),
#             Strength = sd(Norm_Strength, na.rm = T),
#             n = n()) %>%
#   arrange(Macro_game_type)
#
# opts <- options(knitr.kable.NA = "")
# kbl(hp4_sd, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Standard Deviation") %>%
#   kable_styling(position = "left", full_width = F) %>%
#   column_spec(1, bold = T)
hp4_SP_CS <- master %>%
subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
group_by(Macro_game_type) %>%
summarise(Specificity = mean(1/(Sd_Avg_NE), na.rm = T),
Consistency = mean(1/(sqrt(Var_NE)), na.rm = T)) %>%
arrange(Macro_game_type)
F_test_spec <- wilcox.test(1/(master_test$Sd_Avg_NE) ~ master_test$Macro_game_type)
F_test_cons <- wilcox.test(1/(sqrt(master_test$Var_NE)) ~ master_test$Macro_game_type)
hp4plus_SP_CS <- hp4_SP_CS %>%
add_row(Macro_game_type = "Difference (Wilcoxon p-value)", Specificity = F_test_spec$p.value, Consistency = F_test_cons$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_SP_CS, digits = 4, booktabs = T, align = "lcc", centering = F, caption = "Consistency e Specificity") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/Sd_Avg_NE))) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
beliefs_w
choices_w
individual_db_w
merge.data.frame(choices_w, beliefs_w)
beliefs_w
choices_w
beliefs_w
