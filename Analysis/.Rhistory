for (i in Social_Norms_meta$Environment){
if (i =="Field"){
x <- append(x, "Environment")
}else{
x <- append(x,NA)}
}
return(x)
}
Social_Norms_meta$Problem <- paste(GameType_F(),Elicitation_F(), Field_F(), sep = ", ")
result <- Social_Norms_meta$Problem
result
Report <- subset(Social_Norms_meta, select = c(TreatmentID, Problem))
View(Report)
for (i in Social_Norms_meta$Environment){
if (i =="Field"){
x <- append(x, "Environment")
}else{
x <- append(x,NA)}
}
GameType_F <- function()
{
x <- c()
for (i in Social_Norms_meta$Game_type){
#print(i)
if (i %not_in% GameTypeList){
x <- append(x, "Game Type")
}else{
x <- append(x, NA)}
}
return(x)
}
Elicitation_F <- function()
{
x <- c()
for (i in Social_Norms_meta$Method_elicitation){
if (i %not_in% ElicitList){
x <- append(x, "Elicitation")
}else{
x <- append(x, NA)}
}
return(x)
}
Field_F <- function()
{
x <- c()
for (i in Social_Norms_meta$Environment){
if (i %not_in% EnvironmentList){
x <- append(x, "Environment")
}else{
x <- append(x, NA)}
}
return(x)
}
Social_Norms_meta$Problem <- paste(GameType_F(),Elicitation_F(), Field_F(), sep = ", ")
result <- Social_Norms_meta$Problem
result
Report <- subset(Social_Norms_meta, select = c(TreatmentID, Problem))
Report <- subset(Social_Norms_meta, select = c(TreatmentID, Problem))
View(Report)
Social_Norms_meta <- read_excel("Google Drive/Il mio Drive/Meta-analysis beliefs/Social Norms meta.xlsx",
sheet = "ALL")
Social_Norms_meta <- read_excel("Google Drive/Il mio Drive/Meta-analysis beliefs/Social Norms meta.xlsx",
sheet = "ALL")
Social_Norms_meta$TreatmentID <- paste(Social_Norms_meta$PaperID,Social_Norms_meta$TreatmentCode,sep = "_")
rm(list = ls())
Social_Norms_meta <- read_excel("Google Drive/Il mio Drive/Meta-analysis beliefs/Social Norms meta.xlsx",
sheet = "ALL")
Social_Norms_meta$TreatmentID <- paste(Social_Norms_meta$PaperID,Social_Norms_meta$TreatmentCode,sep = "_")
'%not_in%' <- Negate('%in%')
#---------------------------------------------------------------------------------------
#Report creation
#---------------------------------------------------------------------------------------
GameTypeList <- c("DG", "PDG", "PGG", "TG", "UG", "GEG", "Donation Game")
EnvironmentList <- c("Lab", "Classroom", "Online")
ElicitList <- c("KW")
GameType_F <- function()
{
x <- c()
for (i in Social_Norms_meta$Game_type){
#print(i)
if (i %not_in% GameTypeList){
x <- append(x, "Game Type")
}else{
x <- append(x, NA)}
}
return(x)
}
Elicitation_F <- function()
{
x <- c()
for (i in Social_Norms_meta$Method_elicitation){
if (i %not_in% ElicitList){
x <- append(x, "Elicitation")
}else{
x <- append(x, NA)}
}
return(x)
}
Field_F <- function()
{
x <- c()
for (i in Social_Norms_meta$Environment){
if (i %not_in% EnvironmentList){
x <- append(x, "Environment")
}else{
x <- append(x, NA)}
}
return(x)
}
Social_Norms_meta$Problem <- paste(GameType_F(),Elicitation_F(), Field_F(), sep = ", ")
result <- Social_Norms_meta$Problem
result
Report <- subset(Social_Norms_meta, select = c(n_Paper, TreatmentID, Problem))
View(Report)
getwd()
setwd("~/Documents/GitHub/Social_norm_meta_analysis/Analysis")
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mclogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, alpha=NA, beta=NA,var_alpha=NA,var_beta=NA)
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
mlogit.kim <- mlogit(A~payoff+KW_Normative|-1, data = Kim003)
library(mlogit)
Kim003 = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
Kim003 <- dfidx(Kim003 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
head(Kim003)
mlogit.kim <- mlogit(A~payoff+KW_Normative|-1, data = Kim003)
summary(mlogit.kim)$CoefTable[1,2] ### SUCA
summary(mlogit.kim)### SUCA
mlogit.kim <- mlogit(A~-1+payoff+KW_Normative|-1, data = Kim003)
summary(mlogit.kim)### SUCA
mlogit.kim <- mlogit(A~payoff+KW_Normative, data = Kim003)
mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003)
summary(mlogit.kim)$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
Kim003 = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
Kim003_m <- dfidx(Kim003 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
head(Kim003)
mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
clogit.kim <- clogit(A~payoff+KW_Normative, data = Kim003)
summary(clogit.kim)
clogit.kim <- clogit(A~payoff+KW_Normative =strata(subject_id), data = Kim003)
clogit.kim <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003)
summary(clogit.kim)
Her061 = individual_db_b %>% subset.data.frame(paper_id=="2018Her061") %>% mutate(payoff=endowment-scenarios)
Her061 <- dfidx(Her061 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.her <- mlogit(A~ 0+payoff + KW_Normative, data = Her061)
summary(mlogit.her)
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
clogit.cha <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Cha026)
summary(clogit.cha)
Cha026_m <- dfidx(Cha026 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061)
summary(mlogit.her)
mlogit.her <- mlogit(A~ payoff + KW_Normative, data = Her061)
mlogit.her <- mlogit(A~ 0+payoff + KW_Normative, data = Her061)
summary(mlogit.her)
mlogit.her <- mlogit(A~ -1+payoff + KW_Normative, data = Her061)
summary(mlogit.her)
mlogit.her <- mlogit(A~ payoff + KW_Normative|-1, data = Her061)
summary(mlogit.her)
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061)
summary(mlogit.her)
mlogit.cha <- mlogit(A~ 0+payoff + KW_Normative, data = Cha026_m)
summarise(mlogit.cha)
mlogit.cha <- mlogit(A~ 0+payoff + KW_Normative, data = Cha026_m)
summarise(mlogit.cha)
summary(mlogit.cha)
Bas115 = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115") %>% mutate(payoff=endowment-scenarios)
clogit.bas <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, alpha=NA, beta=NA,var_alpha=NA,var_beta=NA)
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
Bas115 = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115") %>% mutate(payoff=endowment-scenarios)
clogit.bas <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115)
summary(clogit.bas)
dataframe_betas[1,] <- c("2020Bas115",clogit.bas$coefficients["payoff"],clogit.bas$coefficients["KW_Normative"],clogit.bas$var[1,1],clogit.bas$var[2,2])
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
between <-clogit(A~ payoff + KW_Normative, data = individual_db_b)
between <-clogit(A~ payoff + KW_Normative + strata(subject_id), data = individual_db_b)
summary(between)
dataframe_betas[2,] <- c("Avg. Between",between$coefficients["payoff"],between$coefficients["KW_Normative"],between$var[1,1],between$var[2,2])
summary(between)
Kim003 = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
Kim003_m <- dfidx(Kim003 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
head(Kim003)
mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
clogit.kim <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003)
summary(clogit.kim)
summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
summary(clogit.kim)
dataframe_etas[3,] <- c("2016Kim003",clogit.kim$coefficients["payoff"],clogit.kim$coefficients["KW_Normative"],clogit.kim$[1,1],between$var[2,2])
dataframe_etas[3,] <- c("2016Kim003",clogit.kim$coefficients["payoff"],clogit.kim$coefficients["KW_Normative"],clogit.kim$[1,1],clogit.kim$var[2,2])
c("2016Kim003",clogit.kim$coefficients["payoff"],clogit.kim$coefficients["KW_Normative"],clogit.kim$[1,1],clogit.kim$var[2,2])
dataframe_etas[3,] <- c("2016Kim003",clogit.kim$coefficients["payoff"],clogit.kim$coefficients["KW_Normative"],clogit.kim$coefficients[1,1],clogit.kim$var[2,2])
dataframe_etas[3,] <- c("2016Kim003",clogit.kim$coefficients["payoff"],clogit.kim$coefficients["KW_Normative"],clogit.kim$var[1,1],clogit.kim$var[2,2])
dataframe_betas[3,] <- c("2016Kim003",clogit.kim$coefficients["payoff"],clogit.kim$coefficients["KW_Normative"],clogit.kim$var[1,1],clogit.kim$var[2,2])
dataframe_betas
clogit.her <- clogit(A ~ payoff + KW_Normative + strata(subject_id), data=Her061)
Her061 = individual_db_b %>% subset.data.frame(paper_id=="2018Her061") %>% mutate(payoff=endowment-scenarios)
Her061_m <- dfidx(Her061 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m)
clogit.her <- clogit(A ~ payoff + KW_Normative + strata(subject_id), data=Her061)
summary(mlogit.her)
summary(clogit.her)
summary(mlogit.her)
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
Cha026_m <- dfidx(Cha026 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
clogit.cha <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Cha026)
summary(clogit.cha)
mlogit.cha <- mlogit(A~ 0+payoff + KW_Normative, data = Cha026_m)
summary(mlogit.cha)
summary(clogit.cha)
dataframe_betas[4,] <- c("2019Cha026",clogit.cha$coefficients["payoff"],clogit.cha$coefficients["KW_Normative"],clogit.cha$var[1,1],clogit.cha$var[2,2])
dataframe_betas
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mclogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = Sd_Avg_NE
# consistency = sqrt(Var_NE)
master = master %>% mutate(Norm_Strength = 1/sqrt(Var_NE) + 1/Sd_Avg_NE,
Delta = (Avg_NE-Avg_coop))
summary(master$Norm_Strength)
ggplot(data=master, aes(x=Norm_Strength)) +
geom_histogram() + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Macro_game_type)
cor.test(master$Norm_Strength, master$Delta, method= "spearman", exact = F)
ggplot(data=master, aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman")
ggplot(data=master, aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method== "Direct")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG")
hp4_mean <- master %>%
subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
group_by(Macro_game_type) %>%
summarise(Coop = mean(Avg_coop, na.rm = T),
Avg_Norm = mean(Avg_NE, na.rm = T),
Delta = mean(Delta, na.rm = T),
Strength = mean(Norm_Strength, na.rm = T),
n = n()) %>%
arrange(Macro_game_type)
master_test <- master %>% subset.data.frame(select = c(Game_type, Avg_coop, Avg_NE, Delta, Norm_Strength, Macro_game_type, Sd_Avg_NE, Var_NE), subset = Game_type %in% c("DG", "UG"))
wilc_delta = wilcox.test(Delta ~ Macro_game_type, data=master_test)
wilc_strength = wilcox.test(Norm_Strength ~ Macro_game_type, data = master_test)
wilc_coop = wilcox.test(Avg_coop ~ Macro_game_type, data = master_test)
wilc_norm = wilcox.test(Avg_NE ~ Macro_game_type, data = master_test)
hp4plus_mean <- hp4_mean %>% add_row(Macro_game_type = "Difference (Wilcoxon p-value)", Coop = wilc_coop$p.value, Avg_Norm = wilc_norm$p.value, Delta = wilc_delta$p.value, Strength = wilc_strength$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_mean, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Average and Mann-Whitney-Wilcoxon Test") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
# hp4_sd <- master %>%
#   subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
#   group_by(Macro_game_type) %>%
#   summarise(Coop = sd(Avg_coop, na.rm = T),
#             Avg_Norm = sd(Avg_NE, na.rm = T),
#             Delta = sd(Delta, na.rm = T),
#             Strength = sd(Norm_Strength, na.rm = T),
#             n = n()) %>%
#   arrange(Macro_game_type)
#
# opts <- options(knitr.kable.NA = "")
# kbl(hp4_sd, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Standard Deviation") %>%
#   kable_styling(position = "left", full_width = F) %>%
#   column_spec(1, bold = T)
hp4_SP_CS <- master %>%
subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
group_by(Macro_game_type) %>%
summarise(Specificity = mean(1/(Sd_Avg_NE), na.rm = T),
Consistency = mean(1/(sqrt(Var_NE)), na.rm = T)) %>%
arrange(Macro_game_type)
F_test_spec <- wilcox.test(1/(master_test$Sd_Avg_NE) ~ master_test$Macro_game_type)
F_test_cons <- wilcox.test(1/(sqrt(master_test$Var_NE)) ~ master_test$Macro_game_type)
hp4plus_SP_CS <- hp4_SP_CS %>%
add_row(Macro_game_type = "Difference (Wilcoxon p-value)", Specificity = F_test_spec$p.value, Consistency = F_test_cons$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_SP_CS, digits = 4, booktabs = T, align = "lcc", centering = F, caption = "Consistency e Specificity") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
ggarrange(ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/Sd_Avg_NE))) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Macro_game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, alpha=NA, beta=NA,var_alpha=NA,var_beta=NA)
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
Bas115 = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115") %>% mutate(payoff=endowment-scenarios)
clogit.bas <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115)
summary(clogit.bas)
dataframe_betas[1,] <- c("2020Bas115",clogit.bas$coefficients["payoff"],clogit.bas$coefficients["KW_Normative"],clogit.bas$var[1,1],clogit.bas$var[2,2])
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
between <-clogit(A~ payoff + KW_Normative + strata(subject_id), data = individual_db_b)
summary(between)
dataframe_betas[2,] <- c("Avg. Between",between$coefficients["payoff"],between$coefficients["KW_Normative"],between$var[1,1],between$var[2,2])
Kim003 = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
Kim003_m <- dfidx(Kim003 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
head(Kim003)
mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
clogit.kim <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003)
summary(clogit.kim)
dataframe_betas[3,] <- c("2016Kim003",clogit.kim$coefficients["payoff"],clogit.kim$coefficients["KW_Normative"],clogit.kim$var[1,1],clogit.kim$var[2,2])
Her061 = individual_db_b %>% subset.data.frame(paper_id=="2018Her061") %>% mutate(payoff=endowment-scenarios)
Her061_m <- dfidx(Her061 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m)
clogit.her <- clogit(A ~ payoff + KW_Normative + strata(subject_id), data=Her061)
summary(mlogit.her)
summary(clogit.her)
dataframe_betas[4,] <- c("2018Her061",clogit.her$coefficients["payoff"],clogit.her$coefficients["KW_Normative"],clogit.her$var[1,1],clogit.her$var[2,2])
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
Cha026_m <- dfidx(Cha026 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
clogit.cha <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Cha026)
summary(clogit.cha)
mlogit.cha <- mlogit(A~ 0+payoff + KW_Normative, data = Cha026_m)
summary(mlogit.cha)
dataframe_betas[5,] <- c("2019Cha026",clogit.cha$coefficients["payoff"],clogit.cha$coefficients["KW_Normative"],clogit.cha$var[1,1],clogit.cha$var[2,2])
dataframe_betas
View(dataframe_betas)
MRS=2*dataframe_betas$beta/dataframe_betas$alpha
MRS=dataframe_betas$beta/dataframe_betas$alpha
MRS=dataframe_betas$beta\dataframe_betas$alpha
MRS=2*as.numeric(dataframe_betas$beta)/as.numeric(dataframe_betas$alpha)
MRS
MRS=as.numeric(dataframe_betas$beta)/as.numeric(dataframe_betas$alpha)
MRS
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mclogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, alpha=NA, beta=NA,var_alpha=NA,var_beta=NA)
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within")
choices_w <- choices %>% subset.data.frame(subset = Design=="Within")
individual_db_w <- merge.data.frame(choices_w, beliefs_w)
Bas115 = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115") %>% mutate(payoff=endowment-scenarios)
clogit.bas <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115)
summary(clogit.bas)
dataframe_betas[1,] <- c("2020Bas115",clogit.bas$coefficients["payoff"],clogit.bas$coefficients["KW_Normative"],clogit.bas$var[1,1],clogit.bas$var[2,2])
beliefs_b <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
between <-clogit(A~ payoff + KW_Normative + strata(subject_id), data = individual_db_b)
summary(between)
dataframe_betas[2,] <- c("Avg. Between",between$coefficients["payoff"],between$coefficients["KW_Normative"],between$var[1,1],between$var[2,2])
individual_db_b
between <-clogit(A~ payoff + KW_Normative + KW_Normative*paper_id + strata(subject_id), data = individual_db_b)
summary(between)
between <-clogit(A~ payoff + KW_Normative + KW_Normative:paper_id + strata(subject_id), data = individual_db_b)
summary(between)
individual_db_b
summary(between)
dataframe_betas[2,] <- c("Avg. Between",between$coefficients["payoff"],between$coefficients["KW_Normative"],between$var[1,1],between$var[2,2])
dataframe_betas
Kim003 = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
Kim003_m <- dfidx(Kim003 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
head(Kim003)
mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
library(mlogit)
mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
Kim003_m <- dfidx(Kim003 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
clogit.kim <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003)
summary(clogit.kim)
dataframe_betas[3,] <- c("2016Kim003",clogit.kim$coefficients["payoff"],clogit.kim$coefficients["KW_Normative"],clogit.kim$var[1,1],clogit.kim$var[2,2])
Her061 = individual_db_b %>% subset.data.frame(paper_id=="2018Her061") %>% mutate(payoff=endowment-scenarios)
Her061_m <- dfidx(Her061 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m)
clogit.her <- clogit(A ~ payoff + KW_Normative + strata(subject_id), data=Her061)
summary(mlogit.her)
summary(clogit.her)
dataframe_betas[4,] <- c("2018Her061",clogit.her$coefficients["payoff"],clogit.her$coefficients["KW_Normative"],clogit.her$var[1,1],clogit.her$var[2,2])
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
Cha026_m <- dfidx(Cha026 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
clogit.cha <- clogit(A~ payoff + KW_Normative + strata(subject_id, treatment_id, paper_id), data = Cha026)
summary(clogit.cha)
mlogit.cha <- mlogit(A~ 0+payoff + KW_Normative, data = Cha026_m)
summary(mlogit.cha)
dataframe_betas[5,] <- c("2019Cha026",clogit.cha$coefficients["payoff"],clogit.cha$coefficients["KW_Normative"],clogit.cha$var[1,1],clogit.cha$var[2,2])
kable(dataframe_betas)
kable(dataframe_betas %>% mutate(MRS = 2*beta/alpha))
kable(dataframe_betas %>% mutate(MRS = 2*as.numeric(beta/as.numeric(alpha)))
kable(dataframe_betas %>% mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)))
kable(dataframe_betas %>% mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)))
kable(dataframe_betas %>% mutate_all(as.numeric) %>% mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)), digits = 2)
kable(dataframe_betas %>% mutate_at(.vars = alpha:var_beta, as.numeric) %>% mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)), digits = 2)
kable(dataframe_betas %>% mutate_at(.vars = c(alpha:var_beta), as.numeric) %>% mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)), digits = 2)
kable(dataframe_betas %>% mutate_at(.vars = vars(alpha:var_beta), as.numeric) %>% mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha)), digits = 2)
View(individual_db_b)
View(master)
# bas155
bas115_strenght <- Bas115 %>% group_by(subject_id) %>% summarise(specificity = sd(KW_Normative))
bas115_strenght
View(Bas115)
high=c(-1,-1,1,-1,-0.6,-0.3,1,1,1,1,1)
sd(high)
low=c(-1,-1,-1,-0.6,-0.6,-0.3,1,0.6,0.3,-0.3,-0.3)
sd(low)
hist(low)
hist(low)
hist(high)
data_bas115 <- Bas115 %>% merge.data.frame(bas115_strenght)
data_bas115
clogit(A ~ payoff + KW_Normative + specificity + strata(subject_id), data=data_bas115)
clogit(A ~ payoff + KW_Normative | specificity + strata(subject_id), data=data_bas115)
clogit(A ~ payoff + KW_Normative*specificity + strata(subject_id), data=data_bas115)
data_bas115_m <- dfidx(data_bas115 %>% mutate(scenarios=as.factor(scenarios)),
idx = c("subject_id","scenarios"),
idpkg = "mlogit")
mlogit(A ~ payoff + KW_Normative*specificity, data=data_bas115_m)
mlogit(A ~ payoff | KW_Normative + specificity, data=data_bas115_m)
mlogit(A ~ payoff |0+ KW_Normative + specificity, data=data_bas115_m)
summary(mlogit(A ~ payoff |0+ KW_Normative + specificity, data=data_bas115_m))
summary(mlogit(A ~ 0+ payoff | KW_Normative + specificity, data=data_bas115_m))
summary(mlogit(A ~ KW_Normative + specificity, data=data_bas115_m))
summary(mlogit(A ~ payoff + specificity|KW_Normative , data=data_bas115_m))
summary(mlogit(A ~ payoff + specificity|0+KW_Normative , data=data_bas115_m))
summary(mlogit(A ~ 0+ payoff + specificity|KW_Normative , data=data_bas115_m))
summary(mlogit(A ~ specificity|KW_Normative , data=data_bas115_m))
summary(mlogit(A ~ payoff |KW_Normative|specificity , data=data_bas115_m))
