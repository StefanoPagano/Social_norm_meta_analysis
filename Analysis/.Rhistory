cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = mean of max deviation
# consistency = sqrt(Var_NE)
master = master %>% mutate(consistency=1/sqrt(Var_NE),
Norm_Strength = 1/sqrt(Var_NE) + specificity,
Delta = (Avg_NE-Avg_coop))
summary(master$Norm_Strength)
summary(master$specificity)
summary(master$consistency)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength)) +
geom_histogram() + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Game_type)
cor.test(master$consistency, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
cor.test(master$specificity, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
cor.test(master$Norm_Strength, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method!= "OnlyNorms")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG"& Choice_Method!= "OnlyNorms")
hp4_mean <- master %>%
subset.data.frame(subset = Game_type %in% c("DG", "UG")&Choice_Method != "OnlyNorms") %>%
group_by(Game_type) %>%
summarise(Coop = mean(Avg_coop, na.rm = T),
Avg_Norm = mean(Avg_NE, na.rm = T),
Delta = mean(Delta, na.rm = T),
Strength = mean(Norm_Strength, na.rm = T),
n = n()) %>%
arrange(Game_type)
master_test <- master %>% subset.data.frame(select = c(Game_type, Avg_coop, Avg_NE, Delta, Norm_Strength, Macro_game_type, Sd_Avg_NE, Var_NE), subset = Game_type %in% c("DG", "UG"))
wilc_delta = wilcox.test(Delta ~ Macro_game_type, data=master_test)
wilc_strength = wilcox.test(Norm_Strength ~ Macro_game_type, data = master_test)
wilc_coop = wilcox.test(Avg_coop ~ Macro_game_type, data = master_test)
wilc_norm = wilcox.test(Avg_NE ~ Macro_game_type, data = master_test)
hp4plus_mean <- hp4_mean %>% add_row(Game_type = "Difference (M.W.W. p-value)", Coop = wilc_coop$p.value, Avg_Norm = wilc_norm$p.value, Delta = wilc_delta$p.value, Strength = wilc_strength$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_mean, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Average and Mann-Whitney-Wilcoxon Test") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
# hp4_sd <- master %>%
#   subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
#   group_by(Macro_game_type) %>%
#   summarise(Coop = sd(Avg_coop, na.rm = T),
#             Avg_Norm = sd(Avg_NE, na.rm = T),
#             Delta = sd(Delta, na.rm = T),
#             Strength = sd(Norm_Strength, na.rm = T),
#             n = n()) %>%
#   arrange(Macro_game_type)
#
# opts <- options(knitr.kable.NA = "")
# kbl(hp4_sd, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Standard Deviation") %>%
#   kable_styling(position = "left", full_width = F) %>%
#   column_spec(1, bold = T)
hp4_SP_CS <- master %>%
subset.data.frame(subset = Game_type %in% c("DG", "UG")) %>%
group_by(Game_type) %>%
summarise(Specificity = mean(1/(Sd_Avg_NE), na.rm = T),
Consistency = mean(1/(sqrt(Var_NE)), na.rm = T)) %>%
arrange(Game_type)
F_test_spec <- wilcox.test(1/(master_test$Sd_Avg_NE) ~ master_test$Game_type)
F_test_cons <- wilcox.test(1/(sqrt(master_test$Var_NE)) ~ master_test$Game_type)
hp4plus_SP_CS <- hp4_SP_CS %>%
add_row(Game_type = "Difference (Wilcoxon p-value)", Specificity = F_test_spec$p.value, Consistency = F_test_cons$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_SP_CS, digits = 4, booktabs = T, align = "lcc", centering = F, caption = "Consistency e Specificity") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
ggarrange(ggplot(master_test) + geom_density(aes(color = Game_type, x=log(1/Sd_Avg_NE))) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,KW_Normative,Game_type))
choices_w <- choices %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,A,choice,Game_type, endowment))
individual_db_w <- choices_w %>% merge.data.frame(beliefs_w)
i=i+1
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_1a"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",1,"DG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_2a"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",2, "DG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
Bas115_ug = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="UG") %>% mutate(payoff=endowment-scenarios)
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_1c"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",3,"UG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_2c"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",4, "UG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
beliefs_b <- beliefs_temp %>% merge.data.frame(Kim003_interpolation, all = T)
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
i=i+1
Kim003_dg = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003"&Game_type=="DG") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
clogit.kim_dg <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003_dg)
summary(clogit.kim_dg)
dataframe_betas[i,] <- c("2016Kim003",1,"DG",clogit.kim_dg$coefficients["payoff"],clogit.kim_dg$coefficients["KW_Normative"],sqrt(clogit.kim_dg$var[1,1]),sqrt(clogit.kim_dg$var[2,2]))
i=i+1
Kim003_ug = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003"&Game_type=="UG") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subject_id!="2016Kim003_8_1804" & subject_id!="2016Kim003_8_2411")
#mlogit.kim <- mlogit(A~payoff+KW_Normative|0, data = Kim003_m)
#summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
clogit.kim_ug <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003_ug)
summary(clogit.kim_ug)
dataframe_betas[i,] <- c("2016Kim003",2,"UG",clogit.kim_ug$coefficients["payoff"],clogit.kim_ug$coefficients["KW_Normative"],sqrt(clogit.kim_ug$var[1,1]),sqrt(clogit.kim_ug$var[2,2]))
# Kim003_m <- dfidx(Kim003_ug %>% mutate(scenarios=as.factor(scenarios)),
#             idx = c("subject_id","scenarios"),
#             idpkg = "mlogit")
# mlogit.kim <- mlogit(A~payoff+KW_Normative|-1, data = Kim003_m, rpar = c(KW_Normative="n", payoff="n"))
# #summary(mlogit.kim)#$CoefTable[1,2] ### SUCA 2beta/alpha monetary trade off from -1 to 1
# mxcl <- update(mlogit.kim, correlation=T)
# kw_n <- rpar(mxcl,"KW_Normative", norm="payoff")
# #summary(kw_n)
# p=fitted(mxcl,type = "parameters")
# ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
i=i+1
Her061 = individual_db_b %>% subset.data.frame(paper_id=="2018Her061") %>% mutate(payoff=endowment-scenarios)
clogit.her <- clogit(A ~ payoff + KW_Normative + strata(subject_id), data=Her061)
summary(clogit.her)
dataframe_betas[i,] <- c("2018Her061",1,"DG",clogit.her$coefficients["payoff"],clogit.her$coefficients["KW_Normative"],sqrt(clogit.her$var[1,1]),sqrt(clogit.her$var[2,2]))
# Her061_m <- dfidx(Her061 %>% mutate(scenarios=as.factor(scenarios)),
#             idx = c("subject_id","scenarios"),
#             idpkg = "mlogit")
# mlogit.her <- mlogit(A~ payoff + KW_Normative|0, data = Her061_m, rpar = c(payoff="n", KW_Normative="n"))
# mxcl <- update(mlogit.her, correlation=T)
# kw_n <- rpar(mxcl,"KW_Normative", norm="payoff")
# summary(mlogit.her)
# p=fitted(mxcl,type = "parameters")
# ggplot(data.frame(betas=p[,2]), aes(x=betas)) + geom_density()
# mean(data.frame(betas=p[,2])$betas, na.rm = T)
i=i+1
Cha026 = individual_db_b %>% subset.data.frame(paper_id=="2019Cha026") %>% mutate(payoff=endowment-scenarios)
#Cha026_m <- dfidx(Cha026 %>% mutate(scenarios=as.factor(scenarios)),
#            idx = c("subject_id","scenarios"),
#            idpkg = "mlogit")
clogit.cha_1 <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Cha026%>% subset.data.frame(treatment_id=="2019Cha026_1"))
summary(clogit.cha_1)
#mlogit.cha <- mlogit(A~ 0+payoff + KW_Normative, data = Cha026_m)
#summary(mlogit.cha)
dataframe_betas[i,] <- c("2019Cha026",1, "DG", clogit.cha_1$coefficients["payoff"],clogit.cha_1$coefficients["KW_Normative"],sqrt(clogit.cha_1$var[1,1]),sqrt(clogit.cha_1$var[2,2]))
i=i+1
clogit.cha_2 <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Cha026%>% subset.data.frame(treatment_id=="2019Cha026_2"))
summary(clogit.cha_2)
dataframe_betas[i,] <- c("2019Cha026",2, "DG", clogit.cha_2$coefficients["payoff"],clogit.cha_2$coefficients["KW_Normative"],sqrt(clogit.cha_2$var[1,1]),sqrt(clogit.cha_2$var[2,2]))
allpaperdata <- dataframe_betas %>%
mutate_at(.vars = vars(alpha:SE_beta), as.numeric) %>%
mutate(MRS = 2*as.numeric(beta)/as.numeric(alpha))
averages <- allpaperdata %>% summarise_at(.vars = vars(alpha:SE_beta), mean)
allpaperdata <- allpaperdata %>% add_row(ID="Average",t= "",game="", alpha=averages$alpha, beta=averages$beta, SE_alpha=averages$SE_alpha, SE_beta=averages$SE_beta, MRS=2*averages$beta/averages$alpha)
opts <- options(knitr.kable.NA = "")
kbl(allpaperdata, digits = 2, booktabs = T, align = "lccccc", centering = F, caption = "Estimated Parameters") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T)
ggplot(allpaperdata %>% mutate(uniqueID=paste(ID,t,sep = "_t")) %>% arrange(beta), aes(x=beta,y=uniqueID,color=ID)) +
geom_point() +
geom_errorbar(aes(xmin=beta-2*SE_beta,xmax=beta+2*SE_beta))
Bas115_ug
Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_1c")
Bas115_dg
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_1a"))
summary(model)
Bas115_dg
str(Bas115_dg)
1375/11
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,KW_Normative,Game_type))
choices_w <- choices %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,A,choice,Game_type, endowment))
beliefs_w
choices_w
individual_db_w
individual_db_w <- choices_w %>% merge.data.frame(beliefs_w)
individual_db_w
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
Bas115_dg
1397/11
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,KW_Normative,Game_type))
choices_w <- choices %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,A,choice,Game_type, endowment))
individual_db_w <- choices_w %>% merge.data.frame(beliefs_w)
individual_db_w
levels(as.factor(individual_db_w$paper_id))
levels(as.factor(individual_db_w$Game_type))
table(individual_db_w$Game_type, individual_db_w$paper_id)
1375/11
1297/11
1397/11
250*11
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,KW_Normative,Game_type))
choices_w <- choices %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,A,choice,Game_type, endowment))
individual_db_w <- choices_w %>% merge.data.frame(beliefs_w)
individual_db_w
2728/11
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
Bas115_dg
1375/11
Bas115_dg
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,KW_Normative,Game_type))
choices_w <- choices %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,A,choice,Game_type, endowment))
individual_db_w <- choices_w %>% merge.data.frame(beliefs_w)
Bas115_dg
2750/11
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type), SD_NE=sqrt(Var_NE)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = mean of max deviation
# consistency = sqrt(Var_NE)
master = master %>% mutate(consistency=1/sqrt(Var_NE),
Norm_Strength = 1/sqrt(Var_NE) + specificity,
Delta = (Avg_NE-Avg_coop))
summary(master$Norm_Strength)
summary(master$specificity)
summary(master$consistency)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength)) +
geom_histogram() + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Game_type)
cor.test(master$consistency, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
cor.test(master$specificity, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
cor.test(master$Norm_Strength, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method!= "OnlyNorms")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG"& Choice_Method!= "OnlyNorms")
hp4_mean <- master %>%
subset.data.frame(subset = Game_type %in% c("DG", "UG")&Choice_Method != "OnlyNorms") %>%
group_by(Game_type) %>%
summarise(Coop = mean(Avg_coop, na.rm = T),
Avg_Norm = mean(Avg_NE, na.rm = T),
Delta = mean(Delta, na.rm = T),
Strength = mean(Norm_Strength, na.rm = T),
n = n()) %>%
arrange(Game_type)
master_test <- master %>% subset.data.frame(select = c(Game_type, Avg_coop, Avg_NE, Delta, Norm_Strength, Macro_game_type, Sd_Avg_NE, Var_NE), subset = Game_type %in% c("DG", "UG"))
wilc_delta = wilcox.test(Delta ~ Macro_game_type, data=master_test)
wilc_strength = wilcox.test(Norm_Strength ~ Macro_game_type, data = master_test)
wilc_coop = wilcox.test(Avg_coop ~ Macro_game_type, data = master_test)
wilc_norm = wilcox.test(Avg_NE ~ Macro_game_type, data = master_test)
hp4plus_mean <- hp4_mean %>% add_row(Game_type = "Difference (M.W.W. p-value)", Coop = wilc_coop$p.value, Avg_Norm = wilc_norm$p.value, Delta = wilc_delta$p.value, Strength = wilc_strength$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_mean, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Average and Mann-Whitney-Wilcoxon Test") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
# hp4_sd <- master %>%
#   subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
#   group_by(Macro_game_type) %>%
#   summarise(Coop = sd(Avg_coop, na.rm = T),
#             Avg_Norm = sd(Avg_NE, na.rm = T),
#             Delta = sd(Delta, na.rm = T),
#             Strength = sd(Norm_Strength, na.rm = T),
#             n = n()) %>%
#   arrange(Macro_game_type)
#
# opts <- options(knitr.kable.NA = "")
# kbl(hp4_sd, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Standard Deviation") %>%
#   kable_styling(position = "left", full_width = F) %>%
#   column_spec(1, bold = T)
hp4_SP_CS <- master %>%
subset.data.frame(subset = Game_type %in% c("DG", "UG")) %>%
group_by(Game_type) %>%
summarise(Specificity = mean(1/(Sd_Avg_NE), na.rm = T),
Consistency = mean(1/(sqrt(Var_NE)), na.rm = T)) %>%
arrange(Game_type)
F_test_spec <- wilcox.test(1/(master_test$Sd_Avg_NE) ~ master_test$Game_type)
F_test_cons <- wilcox.test(1/(sqrt(master_test$Var_NE)) ~ master_test$Game_type)
hp4plus_SP_CS <- hp4_SP_CS %>%
add_row(Game_type = "Difference (Wilcoxon p-value)", Specificity = F_test_spec$p.value, Consistency = F_test_cons$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_SP_CS, digits = 4, booktabs = T, align = "lcc", centering = F, caption = "Consistency e Specificity") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
ggarrange(ggplot(master_test) + geom_density(aes(color = Game_type, x=log(1/Sd_Avg_NE))) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,KW_Normative,Game_type))
choices_w <- choices %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,A,choice,Game_type, endowment))
individual_db_w <- choices_w %>% merge.data.frame(beliefs_w)
individual_db_w
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
Bas115_dg
choices
beliefs
2750/11
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,KW_Normative,Game_type))
choices_w <- choices %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,A,choice,Game_type, endowment))
individual_db_w <- choices_w %>% merge.data.frame(beliefs_w)
individual_db_w
Bas115_dg
i=i+1
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_1a"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",1,"DG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
Bas115_dg
Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_1a"
Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_1a")
Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_1a")
Bas115_ug = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="UG") %>% mutate(payoff=endowment-scenarios)
Bas115_ug
1353/11
Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_2c")
Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_2c")
suca=Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_2c")
str(suca)
693/11
700/11
704/11
1397/11
Bas115_ug
1353/11
rm(list=ls())
library(ggplot2)
library(tidyverse)
library(mlogit)
library(sjmisc)
library(ggrepel)
library(readxl)
library(ggpubr)
library(survival)
library(sjPlot)
library(kableExtra)
library(car)
library(DT)
library(zoo)
setwd("../")
# read data
master <- read.csv("File_DB/Output/Treatment.csv") %>%
mutate(Macro_game_type = ifelse(Game_type %in% c("DG","Donation Game"), "DG and Donation Game", Game_type), SD_NE=sqrt(Var_NE)) %>%
subset.data.frame(subset = !(Standard_game %in% c("N")))
cor.test(master$Avg_NE, master$Avg_coop, method= "spearman", exact = F)
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 1: H1 : Correlation Between Average Cooperation and Norm (NE)") + stat_cor(method = "spearman") + xlab("Cooperation Norm (as % of endowment)") + ylab("Cooperation (% of endowment)")
ggplot(data=master, aes(x=Avg_NE, y=Avg_coop)) + geom_point() + geom_smooth(method = "lm") + ggtitle("Fig. 2: H1 : Correlation Between Average Cooperation and Norm (NE)") + facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")
# specificity = mean of max deviation
# consistency = sqrt(Var_NE)
master = master %>% mutate(consistency=1/sqrt(Var_NE),
Norm_Strength = 1/sqrt(Var_NE) + specificity,
Delta = (Avg_NE-Avg_coop))
summary(master$Norm_Strength)
summary(master$specificity)
summary(master$consistency)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength)) +
geom_histogram() + ggtitle("Histogram of Norm Strength") + xlab("Strength Norm") + facet_wrap(~Game_type)
cor.test(master$consistency, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=consistency, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
cor.test(master$specificity, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=specificity, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
cor.test(master$Norm_Strength, master$Delta, method= "spearman", exact = F)
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm") + stat_cor(method = "spearman") #geom_text(aes(label=PaperID))
ggplot(data=master%>% subset.data.frame(Choice_Method!="OnlyNorms"), aes(x=Norm_Strength, y=Delta)) + geom_point() + geom_smooth(method = "lm")+ facet_wrap(~Macro_game_type, ncol=3) + stat_cor(method = "spearman")# + geom_text(aes(label=PaperID))
DG <- master %>% subset.data.frame(Game_type=="DG" & Choice_Method!= "OnlyNorms")
DG_UG <- master %>% subset.data.frame(Game_type=="DG"|Game_type=="UG")
UG <- master %>% subset.data.frame(Game_type=="UG"& Choice_Method!= "OnlyNorms")
hp4_mean <- master %>%
subset.data.frame(subset = Game_type %in% c("DG", "UG")&Choice_Method != "OnlyNorms") %>%
group_by(Game_type) %>%
summarise(Coop = mean(Avg_coop, na.rm = T),
Avg_Norm = mean(Avg_NE, na.rm = T),
Delta = mean(Delta, na.rm = T),
Strength = mean(Norm_Strength, na.rm = T),
n = n()) %>%
arrange(Game_type)
master_test <- master %>% subset.data.frame(select = c(Game_type, Avg_coop, Avg_NE, Delta, Norm_Strength, Macro_game_type, Sd_Avg_NE, Var_NE), subset = Game_type %in% c("DG", "UG"))
wilc_delta = wilcox.test(Delta ~ Macro_game_type, data=master_test)
wilc_strength = wilcox.test(Norm_Strength ~ Macro_game_type, data = master_test)
wilc_coop = wilcox.test(Avg_coop ~ Macro_game_type, data = master_test)
wilc_norm = wilcox.test(Avg_NE ~ Macro_game_type, data = master_test)
hp4plus_mean <- hp4_mean %>% add_row(Game_type = "Difference (M.W.W. p-value)", Coop = wilc_coop$p.value, Avg_Norm = wilc_norm$p.value, Delta = wilc_delta$p.value, Strength = wilc_strength$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_mean, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Average and Mann-Whitney-Wilcoxon Test") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
# hp4_sd <- master %>%
#   subset.data.frame(subset = Macro_game_type %in% c("DG and Donation Game", "UG")) %>%
#   group_by(Macro_game_type) %>%
#   summarise(Coop = sd(Avg_coop, na.rm = T),
#             Avg_Norm = sd(Avg_NE, na.rm = T),
#             Delta = sd(Delta, na.rm = T),
#             Strength = sd(Norm_Strength, na.rm = T),
#             n = n()) %>%
#   arrange(Macro_game_type)
#
# opts <- options(knitr.kable.NA = "")
# kbl(hp4_sd, digits = 4, booktabs = T, align = "lccccc", centering = F, caption = "Standard Deviation") %>%
#   kable_styling(position = "left", full_width = F) %>%
#   column_spec(1, bold = T)
hp4_SP_CS <- master %>%
subset.data.frame(subset = Game_type %in% c("DG", "UG")) %>%
group_by(Game_type) %>%
summarise(Specificity = mean(1/(Sd_Avg_NE), na.rm = T),
Consistency = mean(1/(sqrt(Var_NE)), na.rm = T)) %>%
arrange(Game_type)
F_test_spec <- wilcox.test(1/(master_test$Sd_Avg_NE) ~ master_test$Game_type)
F_test_cons <- wilcox.test(1/(sqrt(master_test$Var_NE)) ~ master_test$Game_type)
hp4plus_SP_CS <- hp4_SP_CS %>%
add_row(Game_type = "Difference (Wilcoxon p-value)", Specificity = F_test_spec$p.value, Consistency = F_test_cons$p.value)
opts <- options(knitr.kable.NA = "")
kbl(hp4plus_SP_CS, digits = 4, booktabs = T, align = "lcc", centering = F, caption = "Consistency e Specificity") %>%
kable_styling(position = "left", full_width = F) %>%
column_spec(1, bold = T) %>%
row_spec(3, bold = T, color = "white", background = "#6c757d")
ggarrange(ggplot(master_test) + geom_density(aes(color = Game_type, x=log(1/Sd_Avg_NE))) + xlab("Specificity"),
ggplot(master_test) + geom_density(aes(color = Game_type, x=log(1/sqrt(Var_NE)))) + xlab("Consistency"), common.legend = T)
beliefs <- read.csv("../File_DB/Output/Subjects_beliefs.csv", sep = ",")
choices <- read.csv("../File_DB/Output/Subjects_choices.csv", sep = ",")
dataframe_betas <- data.frame(ID=NA, t=NA, game=NA,alpha=NA, beta=NA,SE_alpha=NA,SE_beta=NA)
i=0
beliefs_w <- beliefs %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,KW_Normative,Game_type))
choices_w <- choices %>% subset.data.frame(subset = Design=="Within") #%>% subset.data.frame(select = c(paper_id,treatment_id,subject_id,scenarios,A,choice,Game_type, endowment))
individual_db_w <- choices_w %>% merge.data.frame(beliefs_w)
i=i+1
Bas115_dg = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="DG") %>% mutate(payoff=endowment-scenarios)
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_1a"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",1,"DG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_dg %>% subset.data.frame(subset = treatment_id =="2020Bas115_2a"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",2, "DG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
Bas115_ug = individual_db_w %>% subset.data.frame(paper_id=="2020Bas115" & Game_type=="UG") %>% mutate(payoff=endowment-scenarios)
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_1c"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",3,"UG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
i=i+1
model <- clogit(A~ payoff + KW_Normative + strata(subject_id), data = Bas115_ug %>% subset.data.frame(subset = treatment_id =="2020Bas115_2c"))
summary(model)
dataframe_betas[i,] <- c("2020Bas115",4, "UG",model$coefficients["payoff"],model$coefficients["KW_Normative"],sqrt(model$var[1,1]),sqrt(model$var[2,2]))
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
beliefs_b <- beliefs_temp %>% merge.data.frame(Kim003_interpolation, all = T)
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
i=i+1
Kim003_dg = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003"&Game_type=="DG") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
clogit.kim_dg <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003_dg)
Kim003_dg
beliefs_temp <- beliefs %>% subset.data.frame(subset = Design=="Between") %>% group_by(paper_id, scenarios) %>% summarise(KW_Normative = mean(KW_Normative))
Kim003_interpolation <- beliefs_temp %>% subset.data.frame(paper_id == "2016Kim003") %>%
rbind.data.frame(data.frame(paper_id="2016Kim003", scenarios=seq(1,15,2), KW_Normative=NA)) %>%
ungroup() %>% arrange(scenarios) %>%
mutate(KW_Normative = na.approx(KW_Normative, maxgap = 1, rule = 1))
beliefs_b <- beliefs_temp %>% merge.data.frame(Kim003_interpolation, all = T)
choices_b <- choices %>% subset.data.frame(subset = Design=="Between")%>% mutate(payoff=endowment-scenarios)
individual_db_b <- merge.data.frame(choices_b, beliefs_b)
i=i+1
Kim003_dg = individual_db_b %>% subset.data.frame(paper_id=="2016Kim003"&Game_type=="DG") %>% mutate(payoff=endowment-scenarios) %>% subset.data.frame(subset = subject_id!="2016Kim003_7_2222")
Kim003_dg
clogit.kim_dg <- clogit(A~payoff+KW_Normative +strata(subject_id), data = Kim003_dg)
